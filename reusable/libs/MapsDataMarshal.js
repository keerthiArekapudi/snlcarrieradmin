/*
 * Copyright (C) 2009-2015 SAP SE or an SAP affiliate company. All rights reserved.
 */
jQuery.sap.declare("splReusable.libs.MapsDataMarshal");jQuery.sap.require("splReusable.exceptions.MissingParametersException");jQuery.sap.require("splReusable.exceptions.InvalidArrayException");jQuery.sap.require("splReusable.libs.SapSplEnums");jQuery.sap.require("splReusable.libs.SapSplVOIconSelector");
splReusable.libs.MapsDataMarshal=function(){var t=this;this.oMapsModelConfiguration={};this.aMapsModelSkeleton=[];this.aClickedPoints=[];this.aPolygonPoints=[];this.iClickCount=0;this.sFirstClickPoint="";this.isMapClickEabled=false;this.isGeofenceSelectDeselectEnabled=true;this.isPointOfInterestSelectDeselectEnabled=false;this.oFlagSkeleton=null;this.oPintOfInterestFlagSkeleton=null;this.oGeoFenceArea=null;this.oGeofenceGate=null;this.oTempArea=null;try{var u="./config/maps/MapsModelConfiguration.json";$.ajax({type:"get",url:u,dataType:"json",async:false}).success(function(c){t.oMapsModelConfiguration=c;}).fail(function(x,a,b){var c=b||x.statusText;throw new Error("Error: "+c);});$.ajax({type:"get",url:"./config/maps/MapsModelSkeleton.json",dataType:"json",async:false}).success(function(s){t.aMapsModelSkeleton=s;for(var i=0;i<s.length;i++){if(s[i].Key==="oPintOfInterestFlagSkeleton"){t.oPintOfInterestFlagSkeleton=s[i].Object;}else if(s[i].Key==="Flag"){t.oFlagSkeleton=s[i].Object;}else if(s[i].Key==="GeoFenceAreas"){t.oGeoFenceArea=s[i].Object;}else if(s[i].Key==="oTruckFlag"){t.oTruckFlagSkeleton=s[i].Object;}else if(s[i].Key==="oIncidentFlag"){t.oIncidentFlagSkeleton=s[i].Object;}else if(s[i].Key==="GeofenceGates"){t.oGeofenceGate=s[i].Object;}else if(s[i].Key==="Area"){t.oTempArea=s[i].Object;}}}).fail(function(x,a,b){var c=b||x.statusText;throw new Error("Error: "+c);});}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of setMapsModelConfigurationJSON function call","MapsDataMarshal.js");}}};
splReusable.libs.MapsDataMarshal.prototype.getMapsModelJSON=function(t){try{var _=null;if(t.constructor===String){if(t===SapSplEnums.configJSON){if(this.oMapsModelConfiguration!==undefined&&this.oMapsModelConfiguration!==null){if(this.oMapsModelConfiguration.constructor===Object){_=this.oMapsModelConfiguration;}else{throw new TypeError();}}else{throw new ReferenceError();}}else{if(this.aMapsModelSkeleton!==undefined&&this.aMapsModelSkeleton!==null){if(this.aMapsModelSkeleton.constructor===Array){if(this.aMapsModelSkeleton.length!==0){for(var i=0;i<this.aMapsModelSkeleton.length;i++){if(this.aMapsModelSkeleton[i].Key===t){_=this.aMapsModelSkeleton[i].Object;}}}else{throw new Error("Empty Array");}}else{throw new TypeError();}}else{throw new ReferenceError();}}}else{throw new TypeError();}if(_.constructor===Object&&_!==undefined&&_!==null){return _;}else{throw new TypeError();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getMapsModelConfigurationJSON function call","MapsDataMarshal.js");}}};
splReusable.libs.MapsDataMarshal.prototype.fnShowPointOfInterestFlags=function(r,v,m){try{if(r!==undefined&&r!==null){if(r.constructor===Object){var f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));f["tooltip"]=r.Name;f["key"]=r.LocationID;f["description"]=r.Name;f["VB:m"]="true";f["VB:c"]="false";if(m&&m==="onFocus"){if(r["Tag"]==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,v.zoom,"RollOver");}else if(r["Tag"]==="LC0002"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewParkingStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",r["ReportedStatus"],v.zoom,"RollOver");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,v.zoom,"RollOver");}}else if(r["Tag"]==="LC0003"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",r["ReportedStatus"],v.zoom,"RollOver");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,v.zoom,"RollOver");}}else if(r["Tag"]==="LC0007"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",r["ReportedStatus"],v.zoom,"RollOver");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,v.zoom,"RollOver");}}else if(r["Tag"]==="ALERT"){f["image"]=SapSplVOIconSelector.getVOIcon("Alert",null,v.zoom,"Focus");}else{throw new Error("Invalid LocationSpecType");}}else if(m&&m==="onEnlarge"){if(r["Tag"]==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,15,"Normal");}else if(r["Tag"]==="LC0002"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewParkingStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",r["ReportedStatus"],15,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,15,"Normal");}}else if(r["Tag"]==="LC0007"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",r["ReportedStatus"],15,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,15,"Normal");}}else if(r["Tag"]==="LC0003"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",r["ReportedStatus"],15,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,15,"Normal");}}}else{if(r["Tag"]==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,v.zoom,"Normal");}else if(r["Tag"]==="LC0002"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewParkingStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",r["ReportedStatus"],v.zoom,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,v.zoom,"Normal");}}else if(r["Tag"]==="LC0007"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",r["ReportedStatus"],v.zoom,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,v.zoom,"Normal");}}else if(r["Tag"]==="LC0003"){if(sap.ui.getCore().getModel("sapSplAppConfigDataModel").getData()["canViewContainerStatus"]===1){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",r["ReportedStatus"],v.zoom,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,v.zoom,"Normal");}}else if(r["Tag"]==="ALERT"){f["image"]=SapSplVOIconSelector.getVOIcon("Alert",null,v.zoom,"Focus");}else{throw new Error("Invalid LocationSpecType");}}var p=jQuery.extend(true,{},this.oPintOfInterestFlagSkeleton);p.SAPVB.Data.Set.N.E.push(f);v.load(p);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowPointOfInterestFlags function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowTourStops=function(r,v){var t={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"TourStops","N":{"name":"TourStops","E":[]}}}}};var f;try{if(r!==undefined&&r!==null){if(r.constructor===Array){for(var i=0;i<r.length;i++){if(r[i].GeometryGeo&&r[i]["ActualSequence"]){f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r[i].GeometryGeo));f["tooltip"]="";f["key"]=r[i].UUID;f["description"]="";f["VB:m"]="true";f["VB:c"]="false";if(Number(r[i]["ActualSequence"])===1){f["image"]="tour_start.png";}else if(Number(r[i]["ActualSequence"])===r.length){f["image"]="tour_end.png";}else{f["image"]="tour_mid_points.png";}t.SAPVB.Data.Set.N.E.push(f);var c=this.convertGeoJSONToString(JSON.parse(r[i].GeometryGeo)).split(";");v.zoomToGeoPosition(parseFloat(c[0],10),parseFloat(c[1],10),12);}}v.load(t);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowIncidenceFlags function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowIncidenceFlags=function(r,v){var i={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"IncidentFlags","N":{"name":"IncidentFlags","E":[]}}}}};try{if(r!==undefined&&r!==null){if(r.constructor===Object){var f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r.SourceLocation));f["tooltip"]="";f["key"]=r.UUID;f["description"]=r.Name;f["VB:m"]="true";f["VB:c"]="false";if(r["MessageType"]==="TM"){f["image"]=SapSplVOIconSelector.getVOIcon("Incident",r["Priority"],v.zoom,"Traffic");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Incident",r["Priority"],v.zoom,"PRM");}i.SAPVB.Data.Set.N.E.push(f);v.load(i);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowIncidenceFlags function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnAddTruckDetailWindowContent=function(e,c,v,i){var d;var g;var D=null;try{if(e!==undefined&&e!==null){var l=JSON.parse(e.getParameter("id"))["DeviceUUID"].split("+").join("").split("/").join("").split("?").join("").split("%").join("").split("#").join("").split("&").join("").split("=").join("");if(JSON.parse(e.getParameter("id"))["RegistrationNumber"]!==null){if(!D){if(sap.ui.getCore().byId(l+v.getId())){sap.ui.getCore().byId(l+v.getId()).destroy();}D=new sap.ui.commons.layout.VerticalLayout({id:l+v.getId()}).addStyleClass("truckDetailWindowLayout").addStyleClass(l).attachBrowserEvent("click",function(){c(this.oData);});D.oData=JSON.parse(e.getParameter("id"));if(!d){d=new sap.m.Image({src:"resources/icons/truckDetailsArrow.png"}).addStyleClass("truckDetailWindowArrowImage");}if(!g){g=new sap.m.Label({text:JSON.parse(e.getParameter("id"))["RegistrationNumber"]}).addStyleClass("truckDetailWindowLabel");}D.addEventDelegate({onAfterRendering:function(){if(i){jQuery("."+l).parent().parent().show();}}});D.addContent(d).addContent(g);D.placeAt(e.getParameter("contentarea").id);}}}else{throw new ReferenceError();}}catch(E){jQuery.sap.log.error(E.message,"Failure of fnAddDetailWindowContent function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowDetailWindowsForTrucks=function(r,v){var t={};t["RegistrationNumber"]=r["RegistrationNumber"];t["DeviceUUID"]=r["DeviceUUID"];t["isTypeTruck"]=true;try{if(r!==undefined&&r!==null){if(r.constructor===Object){var w={"SAPVB":{"version":"2.0","xmlns:VB":"VB","Windows":{"Remove":{"name":"Detail1"},"Set":{"name":"Detail1","Window":{"id":JSON.stringify(t),"type":"callout","refParent":"Window1","refScene":"","modal":"false","width":"150","height":"50","pos":this.convertGeoJSONToString(JSON.parse(r["Position"])),"caption":"","offsetX":"15","offsetY":"-30"}}}}};v.load(w);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowDetailWindowsForTrucks function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowTruckFlags=function(r,v,m){var t={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"TruckFlags","N":{"name":"TruckFlags","E":[]}}}}};try{if(r!==undefined&&r!==null){if(r.constructor===Object){var f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r.Position));f["tooltip"]=r["ReportedTime"];if(r["ReportedTime"]===null){f["tooltip"]="";}else{f["tooltip"]=oSapSplUtils.getBundle().getText("LAST_REPORTED")+" : "+splReusable.libs.SapSplModelFormatters.returnMessageTimestamp(r["ReportedTime"]);}f["key"]=r.DeviceUUID;f["description"]=JSON.stringify(r);f["VB:m"]="true";f["VB:c"]="false";if(m&&(m==="noLabel")){f["labeltext"]="";f["labelbackground"]="RGBA(255,255,255,400)";f["labelposition"]="3";}else{if(r["RegistrationNumber"]!==null){f["labeltext"]=" "+r["RegistrationNumber"]+" ";}else{f["labeltext"]="";}f["labelbackground"]="RGBA(255,255,255,400)";f["labelposition"]="3";}if(r["TourName"]===null){f["image"]=SapSplVOIconSelector.getVOIcon("Truck","NoOrder",v.zoom,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Truck",r["isTruckRunningLate"],v.zoom,"Normal");}t.SAPVB.Data.Set.N.E.push(f);v.load(t);}else{jQuery.sap.log.error("Unable to plot truck position","TourDetailController","SAPSCL");}}else{jQuery.sap.log.error("Unable to plot truck position","TourDetailController","SAPSCL");}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowTruckFlags function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnSelectDeselectPointOfInterests=function(r,v,c){try{if(this.isPointOfInterestSelectDeselectEnabled){var a=null;if(v.aSelectedLocationPOIs===undefined){v.aSelectedLocationPOIs=[];}var b=false;for(var i=0;i<v.aSelectedLocationPOIs.length;i++){if(v.aSelectedLocationPOIs[i].LocationID===r.LocationID){b=true;v.aSelectedLocationPOIs.splice(i,1);a="Deselect";}}if(!b){v.aSelectedLocationPOIs.push(r);a="Select";}if(r!==undefined&&r!==null){if(r.constructor===Object){var f={};f["position"]=r.Geometry;f["tooltip"]=r.Name;f["key"]=r.LocationID;f["description"]=r.Name;f["VB:m"]="true";f["VB:c"]="false";if(a==="Select"){f["image"]="PointOfInterest.png";}else if(a==="Deselect"){if(r["Tag"]==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0002"){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0003"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0007"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,v.zoom,"Focus");}else{throw new Error("Invalid LocationSpecType");}}else{throw new Error("Invalid action argument");}this.oPintOfInterestFlagSkeleton.SAPVB.Data.Set.N.E.push(f);v.load(this.oPintOfInterestFlagSkeleton);}else{throw new TypeError();}}c(v.aSelectedLocationPOIs);}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnSelectDeselectTrucks=function(r,v,c,a){try{var A=null;if(v.aSelectedTrucks===undefined){v.aSelectedTrucks=[];}var b=false;for(var i=0;i<v.aSelectedTrucks.length;i++){if(v.aSelectedTrucks[i].DeviceUUID===r.DeviceUUID){if(a!==undefined&&a!==null){if(a){b=true;A="Select";break;}}else{b=true;v.aSelectedTrucks.splice(i,1);A="Deselect";}}}if(!b){v.aSelectedTrucks.push(r);A="Select";}if(r!==undefined&&r!==null){if(r.constructor===Object){var f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r.Position));f["tooltip"]="";f["key"]=r.DeviceUUID;f["description"]="";f["VB:m"]="true";f["VB:c"]="false";if(A==="Select"){if(r["TourName"]===null){f["image"]=SapSplVOIconSelector.getVOIcon("Truck","NoOrder",v.zoom,"Focus");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Truck",r["isTruckRunningLate"],v.zoom,"Focus");}}else if(A==="Deselect"){if(r["TourName"]===null){f["image"]=SapSplVOIconSelector.getVOIcon("Truck","NoOrder",v.zoom,"Normal");}else{f["image"]=SapSplVOIconSelector.getVOIcon("Truck",r["isTruckRunningLate"],v.zoom,"Normal");}}else{throw new Error("Invalid action argument");}this.oTruckFlagSkeleton.SAPVB.Data.Set.N.E.push(f);v.load(this.oTruckFlagSkeleton);}else{throw new TypeError();}}c(v.aSelectedTrucks);}catch(e){jQuery.sap.log.error(e.message,"Failure of fnSelectDeselectTrucks function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnSelectDeselectFences=function(r,v,c){try{if(this.isGeofenceSelectDeselectEnabled&&r.Geometry){var a=null;if(v.aSelectedLocationFences===undefined){v.aSelectedLocationFences=[];}var b=false;for(var i=0;i<v.aSelectedLocationFences.length;i++){if(v.aSelectedLocationFences[i].LocationID===r.LocationID){b=true;v.aSelectedLocationFences.splice(i,1);a="Deselect";}}if(!b){v.aSelectedLocationFences.push(r);a="Select";}if(r!==undefined&&r!==null){if(r.constructor===Object){var p={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"GeoFenceAreas","N":{"name":"GeoFenceAreas","E":[]}}}}};var P={};P["K"]=r["LocationID"];P["B"]=r["Name"];P["H"]=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));P["VB:c"]="false";if(a==="Select"){P["C"]="ARGB(0x30;0xFF;0x00;0x00)";P["D"]="ARGB(0x64;0xFF;0x00;0x00)";P["HC"]="ARGB(0x64;0xFF;0x00;0x00)";}else if(a==="Deselect"){if(r["isPublic"]==="1"){P["C"]="ARGB(0x60;0x00;0x9D;0xE0)";P["D"]="ARGB(0x60;0xFF;0xFF;0xFF)";P["HC"]="ARGB(0x90;0x00;0x9D;0xE0)";}else{P["C"]="ARGB(0x60;0xF0;0xAB;0x00)";P["D"]="ARGB(0x60;0xFF;0xFF;0xFF)";P["HC"]="ARGB(0x90;0xF0;0xAB;0x00)";}}else{throw new Error("Invalid action argument");}p.SAPVB.Data.Set.N.E.push(P);v.load(p);}else{throw new TypeError();}}c(v.aSelectedLocationFences);}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnEditFences=function(r,v){try{if(r!==undefined&&r!==null){if(r.constructor===Object){if(r["Type"]==="L00001"){var f={};f["position"]=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));f["tooltip"]=r.Name;f["key"]=r.LocationID;f["description"]=r.Name;f["VB:m"]="true";f["VB:c"]="true";if(r["Tag"]==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0002"){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0003"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,v.zoom,"Focus");}else if(r["Tag"]==="LC0007"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,v.zoom,"Focus");}else{throw new Error("Invalid LocationSpecType");}this.oPintOfInterestFlagSkeleton.SAPVB.Data.Set.N.E.push(f);v.load(this.oPintOfInterestFlagSkeleton);}else if(r["Type"]==="L00002"||r["Type"]==="L00005"){var p={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"GeoFenceAreas","N":{"name":"GeoFenceAreas","E":[]}}}}};var P={};if(!r["LocationID"]){P["K"]="location";}else{P["K"]=r["LocationID"];}P["B"]=r["Name"];P["H"]=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));P["VB:c"]="true";P["C"]="ARGB(0x64;0xFF;0x00;0x00)";P["D"]="ARGB(0x64;0xFF;0x00;0x00)";P["HC"]="ARGB(0x30;0xFF;0x00;0x00)";p.SAPVB.Data.Set.N.E.push(P);v.load(p);}else{throw new Error("Invalid Type");}}else{throw new TypeError();}}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnAddDetailWindowContent=function(e,c,v,i){try{if(e!==undefined&&e!==null){var d;var g;var D=null;var a="";var l=JSON.parse(e.getParameter("id"))["LocationID"].split("+").join("").split("/").join("").split("?").join("").split("%").join("").split("#").join("").split("&").join("").split("=").join("");if(!D){if(sap.ui.getCore().byId(l+v.getId())){sap.ui.getCore().byId(l+v.getId()).destroy();}D=new sap.ui.commons.layout.VerticalLayout({id:l+v.getId()}).addStyleClass("detailWindowLayout").addStyleClass(l).attachBrowserEvent("click",function(){c(this.oData);});if(JSON.parse(e.getParameter("id"))["isPublic"]&&(JSON.parse(e.getParameter("id"))["isPublic"]==="1")){D.addStyleClass("detailWindowLayoutBlueBorder");a="vbDetailWindowArrow.png";}else{D.addStyleClass("detailWindowLayoutYellowBorder");a="vbDetailWindowArrowYellow.png";}D.oData=JSON.parse(e.getParameter("id"));if(!d){d=new sap.m.Image({src:"resources/icons/"+a}).addStyleClass("detailWindowArrowImage");}if(!g){g=new sap.m.Label({text:JSON.parse(e.getParameter("id"))["Name"]}).addStyleClass("detailWindowLabel");}D.addEventDelegate({onAfterRendering:function(){if(i){jQuery("."+l).parent().parent().show();}}});D.addContent(d).addContent(g);D.placeAt(e.getParameter("contentarea").id);}}else{throw new ReferenceError();}}catch(E){jQuery.sap.log.error(E.message,"Failure of fnAddDetailWindowContent function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnGetPointFromPolygon=function(p){var c="";var m=-1000;var M=0;var l;var L;var f;var a;var P;var b;var n;var N;var d=p.split(";");for(var j=0;j<d.length;j++){if(j%3===1){if(parseFloat(d[j],10)>=m){m=parseFloat(d[j],10);M=j;}}}if(M===1){f=parseFloat(d[M],10);a=parseFloat(d[M-1],10);b=parseFloat(d[d.length-2],10);P=parseFloat(d[d.length-3],10);N=parseFloat(d[M+3],10);n=parseFloat(d[M+2],10);}else if(M===d.length-2){f=parseFloat(d[M],10);a=parseFloat(d[M-1],10);b=parseFloat(d[M-3],10);P=parseFloat(d[M-4],10);N=parseFloat(d[1],10);n=parseFloat(d[0],10);}else{f=parseFloat(d[M],10);a=parseFloat(d[M-1],10);b=parseFloat(d[M-3],10);P=parseFloat(d[M-4],10);N=parseFloat(d[M+3],10);n=parseFloat(d[M+2],10);}l=(b+N+f)/3;L=(n+P+a)/3;c=L.toString()+";"+l.toString()+";"+"0.0";return c;};
splReusable.libs.MapsDataMarshal.prototype.fnShowDetailWindowsForGeofence=function(r,v){var g={};g["LocationID"]=r["LocationID"];g["Name"]=r["Name"];g["isPublic"]=r["isPublic"];try{if(g["LocationID"]){if(r!==undefined&&r!==null){if(r.constructor===Object){r.sDetailWindowPosition=this.fnGetPointFromPolygon(this.convertGeoJSONToString(JSON.parse(r["Geometry"])));var w={"SAPVB":{"version":"2.0","xmlns:VB":"VB","Windows":{"Set":{"name":"Detail1","Window":{"id":JSON.stringify(g),"type":"callout","refParent":"Window1","refScene":"","modal":"false","width":"150","height":"50","pos":r.sDetailWindowPosition,"caption":"","offsetX":"-30","offsetY":"-40"}}}}};v.load(w);}else{throw new TypeError();}}else{throw new ReferenceError();}}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowDetailWindowsForGeofence function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnAddGateDetailWindowContent=function(e,c,v){try{if(e!==undefined&&e!==null){var d;var g;var D=null;var l=JSON.parse(e.getParameter("id"))["GateUUID"].split("+").join("").split("/").join("").split("?").join("").split("%").join("").split("#").join("").split("&").join("").split("=").join("");if(!D){if(sap.ui.getCore().byId(l+v.getId())){sap.ui.getCore().byId(l+v.getId()).destroy();}D=new sap.ui.commons.layout.VerticalLayout({id:l+v.getId()}).addStyleClass(l).addStyleClass("gateDetailWindowLayout").attachBrowserEvent("click",function(){c(this.oData);});D.oData=JSON.parse(e.getParameter("id"));if(!d){d=new sap.m.Image({src:"resources/icons/truckDetailsArrow.png"}).addStyleClass("gateDetailWindowArrowImage");}if(!g){g=new sap.m.Label({text:JSON.parse(e.getParameter("id"))["Name"]}).addStyleClass("gateDetailWindowLabel");}D.addContent(d).addContent(g);D.placeAt(e.getParameter("contentarea").id);}}else{throw new ReferenceError();}}catch(E){jQuery.sap.log.error(E.message,"Failure of fnAddGateDetailWindowContent function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowDetailWindowsForGates=function(r,v){try{function g(a){var G=a.split(";");for(var i=0;i<G.length;i++){G[i]=parseFloat(G[i],10);}var s=(G[0]+G[3])/2+";"+(G[1]+G[4])/2+";0.0";return s;};if(r!==undefined&&r!==null){if(r.constructor===Object){r["isTypeGate"]=true;var w={"SAPVB":{"version":"2.0","xmlns:VB":"VB","Windows":{"Remove":{"name":"GateDetail"+r["GateUUID"]},"Set":{"name":"GateDetail"+r["GateUUID"],"Window":{"id":JSON.stringify(r),"type":"callout","refParent":"Window1","refScene":"","modal":"false","width":"150","height":"50","pos":g(this.convertGeoJSONToString(JSON.parse(r["GateGeometry"]))),"caption":"","offsetX":"5","offsetY":"-15"}}}}};v.load(w);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowDetailWindowsForTrucks function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnRemoveGates=function(v){try{var f={"SAPVB":{"Data":{"Remove":[{"name":"GeofenceGates","type":"N","N":{"E":{"name":"GeofenceGates"}}},{"name":"GeofenceTempGates","type":"N","N":{"E":{"name":"GeofenceTempGates"}}}]}}};v.load(f);}catch(e){jQuery.sap.log.error(e.message,"Failure of fnRemoveGates function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowTourPath=function(r,v){var l={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"TourPaths","N":{"name":"TourPaths","E":[]}}}}};var p={};if(r){p["key"]=r["key"];p["name"]=r["name"];p["coordinate"]=r["coordinate"];p["color"]=r["color"];p["start"]=r["start"];p["end"]=r["end"];p["dotWidth"]=r["dotWidth"];p["lineWidth"]=r["lineWidth"];}l.SAPVB.Data.Set.N.E.push(p);v.load(l);};
splReusable.libs.MapsDataMarshal.prototype.fnShowGates=function(r,v,t,m){var f;var F={};try{if(r!==undefined&&r!==null){if(r.constructor===Object){if(t==="tempGate"){f={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"GeofenceTempGates","N":{"name":"GeofenceTempGates","E":[]}}}}};if(m==="selected"){F["C"]="ARGB(0x99;0xFF;0xFF;0x00)";}else{F["C"]="ARGB(0x99;0x00;0x9D;0xE0)";}}else{f={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"GeofenceGates","N":{"name":"GeofenceGates","E":[]}}}}};F["C"]="ARGB(0x99;0xFF;0x00;0x00)";this.fnShowDetailWindowsForGates(r,v);}F["K"]=r["GateUUID"];F["T"]=r["Name"];F["P"]=this.convertGeoJSONToString(JSON.parse(r["GateGeometry"]));F["S"]="0";F["E"]="0";F["DW"]="0";F["LW"]="5";f.SAPVB.Data.Set.N.E.push(F);v.load(f);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowGates function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.getEdgesFromGeofence=function(r){try{if(r!==undefined&&r!==null){if(r.constructor===Object){var f=[];var g=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));var G=g.split(";0.0;");G.push(G[0]);for(var i=0;i<G.length-1;i++){var s=G[i];var e=G[i+1];var S=parseFloat(s.split(";")[0],10);var a=parseFloat(s.split(";")[1],10);var E=parseFloat(e.split(";")[0],10);var b=parseFloat(e.split(";")[1],10);var c=S+";"+a+";0.0;"+E+";"+b+";0.0";var F={};F["Name"]="";F["GateGeometry"]=JSON.stringify(this.convertStringToGeoJSON(c));F["GateUUID"]=r["LocationID"]+"."+i;f.push(F);}return f;}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(o){jQuery.sap.log.error(o.message,"Failure of getEdgesFromGeofence function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowFences=function(r,v,m){var p=jQuery.extend(true,{},this.oGeoFenceArea);var P={};try{if(r!==undefined&&r!==null){if(r.constructor===Object){if(!r["LocationID"]){P["K"]="location";}else{P["K"]=r["LocationID"];}P["B"]=r["Name"];P["H"]=this.convertGeoJSONToString(JSON.parse(r["Geometry"]));P["VB:c"]="false";P["C"]="ARGB(0x60;0x00;0x9D;0xE0)";P["D"]="ARGB(0x60;0xFF;0xFF;0xFF)";P["HC"]="ARGB(0x90;0x00;0x9D;0xE0)";if(m&&m==="onFocus"){P["C"]="ARGB(0x60;0xFF;0x00;0x00)";P["D"]="ARGB(0x60;0xFF;0x00;0x00)";P["HC"]="ARGB(0x90;0xFF;0x00;0x00)";}else{if(r["isPublic"]==="1"){P["C"]="ARGB(0x60;0x00;0x9D;0xE0)";P["D"]="ARGB(0x60;0xFF;0xFF;0xFF)";P["HC"]="ARGB(0x90;0x00;0x9D;0xE0)";}else{P["C"]="ARGB(0x60;0xF0;0xAB;0x00)";P["D"]="ARGB(0x60;0xFF;0xFF;0xFF)";P["HC"]="ARGB(0x90;0xF0;0xAB;0x00)";}}p.SAPVB.Data.Set.N.E.push(P);v.load(p);if(m&&m==="onFocus"){this.fnHandleDetailWindowVisibility("Hide","Geofence");this.fnShowDetailWindowsForGeofence(r,v);}}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnRemoveVOsOnMap=function(t,v){var f;var g;var p;var T;var i;var a;var F;var l;try{if(t!==undefined&&t!==null){if(t.constructor===String){a={"SAPVB":{"Data":{"Remove":{"name":"Areas","type":"N","N":{"E":{"name":"Areas"}}}}}};F={"SAPVB":{"Data":{"Remove":{"name":"Flags","type":"N","N":{"E":{"name":"Flags"}}}}}};f={"SAPVB":{"Data":{"Remove":[{"name":"GeofenceGates","type":"N"},{"name":"GeofenceTempGates","type":"N"}]}}};g={"SAPVB":{"version":"2.0","Data":{"Remove":{"type":"N","name":"GeoFenceAreas"}}}};p={"SAPVB":{"version":"2.0","Data":{"Remove":{"type":"N","name":"PointOfInterestFlags"}}}};T={"SAPVB":{"version":"2.0","Data":{"Remove":{"type":"N","name":"TruckFlags"}}}};i={"SAPVB":{"version":"2.0","Data":{"Remove":{"type":"N","name":"IncidentFlags"}}}};l={"SAPVB":{"version":"2.0","Data":{"Remove":{"type":"N","name":"TourPath"}}}};if(t==="All"){v.load(a);v.load(F);v.load(f);v.load(g);v.load(p);v.load(T);v.load(i);v.load(l);}else if(t==="Flag"){v.load(F);}else if(t==="Area"){v.load(a);}else if(t==="Gate"){v.load(f);}else if(t==="Incident"){v.load(i);}else if(t==="Truck"){v.load(T);}else if(t==="TourPath"){v.load(l);}}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnRemoveVOsOnMap function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnShowVOsOnMap=function(r,v){try{if(r!==undefined&&r!==null){if(r.constructor===Array){if(r.length===0){this.fnResetValues(v);this.fnRemoveVOsOnMap("All",v);jQuery.sap.log.info("No locations present","MapsDataMarshal.js");}else{this.fnResetValues(v);this.fnRemoveVOsOnMap("All",v);var l=jQuery(".vbi-detail");var i;for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".detailWindowLayout").length>0){jQuery(l[i]).remove();}}for(i=0;i<r.length;i++){if(r[i]["Tag"]==="LC0004"||r[i]["Tag"]==="LC0008"){this.fnShowFences(r[i],v);}else{this.fnShowPointOfInterestFlags(r[i],v);}}this.fnResetValues(v);}}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowVOsOnMap function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnCreateLine=function(p,e,v){var f={"SAPVB":{"version":"2.0","Data":{"Set":{"type":"N","name":"GeofenceGates","N":{"name":"GeofenceGates","E":[]}}}}};var F={};try{if(p!==undefined&&p!==null&&e!==undefined&&e!==null){if(p.constructor===String){if(this.isMapClickEabled){this.aPolygonPoints.push(p);F["position"]=this.aPolygonPoints[this.iClickCount];F["tooltip"]="";F["key"]=this.iClickCount.toString();F["description"]="";F["image"]="default.png";F["VB:m"]="false";F["VB:c"]="false";this.oFlagSkeleton.SAPVB.Data.Set.N.E.push(F);v.load(this.oFlagSkeleton);if(this.aPolygonPoints.length>=2){var o={};o["C"]="ARGB(0x64;0xFF;0x00;0x00)";o["K"]=this.iClickCount.toString();o["T"]=this.iClickCount.toString();o["P"]=this.aPolygonPoints[this.iClickCount-1]+";"+this.aPolygonPoints[this.iClickCount]+";";o["S"]="0";o["E"]="0";o["DW"]="0";o["LW"]="2";f.SAPVB.Data.Set.N.E.push(o);v.load(f);}this.iClickCount++;}}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(E){jQuery.sap.log.error(E.message,"Failure of fnCreateLine function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnConstructPayload=function(m,c){var p={};try{if(m!==undefined&&m!==null&&c!==undefined&&c!==null){if(m.constructor===String&&c.constructor===Array&&c.length!==0){if(m==="Create"){p.locationGeoCoords=[];for(var i=0;i<c.length;i++){var l=c[i].split(";");var L={};L.lat=l[1];L["long"]=l[0];L.alt=l[2];p.locationGeoCoords.push(L);}}}else{throw new TypeError();}}else{throw new ReferenceError();}return p;}catch(e){jQuery.sap.log.error(e.message,"Failure of fnConstructPayload function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnCreatePolygon=function(v,c){var C="";var r={};try{if(v!==undefined&&v!==null){if(v.constructor===sap.ui.vbm.VBI){for(var i=0;i<this.aPolygonPoints.length;i++){C+=this.aPolygonPoints[i]+";";}C=C.substring(0,C.length-1);this.fnRemoveVOsOnMap("Gate",v);this.fnRemoveVOsOnMap("Flag",v);r={Type:"L00002",LocationID:"location",Name:"",Geometry:JSON.stringify(this.convertStringToGeoJSON(C))};this.fnEditFences(r,v);c(C);}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnCreatePointOfInterestFlag=function(p,v,c,t){try{if(this.isMapClickEabled){if(v!==undefined&&v!==null){if(v.constructor===sap.ui.vbm.VBI){this.aPolygonPoints.push(p);var f={};f["position"]=p;f["tooltip"]="Point";f["key"]="Point"+this.iClickCount;f["description"]="Point"+this.iClickCount;if(t==="LC0001"){f["image"]=SapSplVOIconSelector.getVOIcon("Bridge",null,v.zoom,"Focus");}else if(t==="LC0002"){f["image"]=SapSplVOIconSelector.getVOIcon("Parking",null,v.zoom,"Focus");}else if(t==="LC0003"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerTerminal",null,v.zoom,"Focus");}else if(t==="LC0007"){f["image"]=SapSplVOIconSelector.getVOIcon("ContainerDepot",null,v.zoom,"Focus");}else{f["tooltip"]=oSapSplUtils.getBundle().getText("INCIDENT_LOCATION_TOOLTIP");f["image"]="alert_red.png";}f["VB:m"]="true";f["VB:c"]="false";this.oFlagSkeleton.SAPVB.Data.Set.N.E.push(f);v.load(this.oFlagSkeleton);if(v.zoom){v.zoomToGeoPosition(parseFloat(p.split(";")[0],10),parseFloat(p.split(";")[1],10),parseFloat(v.zoom,10));}var P=this.fnConstructPayload("Create",this.aPolygonPoints);c(P);}else{throw new TypeError();}}else{throw new ReferenceError();}}}catch(e){jQuery.sap.log.error(e.message,"Failure of fnShowFences function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnChangeCursor=function(c){if(oSapSplUtils.bIsInternetExplorer()){var z=-999;var h=null;if(c==="pencil"){jQuery("canvas").each(function(){if(jQuery(this).css("z-index")>z){z=jQuery(this).css("z-index");h=jQuery(this);}});if(h){jQuery("canvas").addClass("oSapSplPenCursor");}}else{jQuery("canvas").each(function(){if(jQuery(this).css("z-index")>z){z=jQuery(this).css("z-index");h=jQuery(this);}});if(h){jQuery("canvas").removeClass("oSapSplPenCursor");}}}else{if(c==="pencil"){jQuery("canvas").addClass("oSapSplPenCursor");}else{jQuery("canvas").removeClass("oSapSplPenCursor");}}};
splReusable.libs.MapsDataMarshal.prototype.convertGeoJSONToString=function(g){var c;var i;try{if(g!==undefined&&g!==null){if(g.constructor===Object){var C="";if(g["type"]==="Point"){c=g["coordinates"];C+=c[0]+";"+c[1]+";"+"0.0;";}else if(g["type"]==="Polygon"){c=g["coordinates"][0];for(i=0;i<c.length-1;i++){C+=c[i][0]+";"+c[i][1]+";"+"0.0;";}}else if(g["type"]==="LineString"){c=g["coordinates"];for(i=0;i<c.length;i++){C+=c[i][0]+";"+c[i][1]+";"+"0.0;";}}var l=C.slice(-1);if(l===";"){C=C.substring(0,C.length-1);}return C;}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of convertGeoJSONToString function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.convertStringToGeoJSON=function(c){var t;try{function a(b){var C=[];for(var i=0;i<b.length;i++){if(i%3===0){t=[];t.push(parseFloat(b[i],10));}else if(i%3===1){t.push(parseFloat(b[i],10));C.push(t);}}return C;};if(c!==undefined&&c!==null){if(c.constructor===String){var g={};var C;var b=c.split(";");if(b.length===3){g["type"]="Point";g["coordinates"]=a(b)[0];}else if(b.length===6){g["type"]="LineString";C=a(b);g["coordinates"]=C;}else if(b.length>=9&&b.length%3===0){g["type"]="Polygon";C=a(b);t=[];t.push(parseFloat(b[0],10));t.push(parseFloat(b[1],10));C.push(t);g["coordinates"]=[C];}else{throw new Error("Invalid coordinates");}return g;}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){jQuery.sap.log.error(e.message,"Failure of convertStringToGeoJSON function call","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.convertGeoCoordToScreenCoord=function(c,v){try{if(c!==undefined&&c!==null&&v!==undefined&&v!==null){if(c.constructor===String&&v.constructor===sap.ui.vbm.VBI){var C=c.split(";");var a=v;var b=a.m_VBIContext;var s=b.m_SceneManager;var d=s.m_SceneArray[0];var p=d.GetPointFromPos([parseFloat(C[0],10),parseFloat(C[1],10),0]);var e=d.m_Canvas[d.m_nOverlayIndex];var r=e.getBoundingClientRect();var o={};o["left"]=r.left+p[0];o["top"]=r.top+p[1];return o;}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(E){}};
splReusable.libs.MapsDataMarshal.prototype.fnHandleDetailWindowVisibility=function(m,c){var l=jQuery(".vbi-detail");var i;if(m==="Hide"){if(c==="All"){for(i=0;i<l.length;i++){if((jQuery(l[i]).find(".gateDetailWindowLayout").length>0)||(jQuery(l[i]).find(".detailWindowLayout").length>0)||(jQuery(l[i]).find(".truckDetailWindowLayout").length>0)){jQuery(l[i]).hide();}}}else if(c==="Geofence"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".detailWindowLayout").length>0){jQuery(l[i]).remove();}}}else if(c==="Gates"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".gateDetailWindowLayout").length>0){jQuery(l[i]).remove();}}}else if(c==="Trucks"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".truckDetailWindowLayout").length>0){jQuery(l[i]).hide();}}}else{jQuery.sap.log.error("fnHandleDetailWindowVisibility","invalid sContext","MapsDataMarshal.js");}}else if(m==="Show"){if(c==="All"){for(i=0;i<l.length;i++){if((jQuery(l[i]).find(".gateDetailWindowLayout").length>0)||(jQuery(l[i]).find(".detailWindowLayout").length>0)||(jQuery(l[i]).find(".truckDetailWindowLayout").length>0)){jQuery(l[i]).show();}}}else if(c==="Geofence"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".detailWindowLayout").length>0){jQuery(l[i]).show();}}}else if(c==="Gates"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".gateDetailWindowLayout").length>0){jQuery(l[i]).show();}}}else if(c==="Trucks"){for(i=0;i<l.length;i++){if(jQuery(l[i]).find(".truckDetailWindowLayout").length>0){jQuery(l[i]).show();}}}else{jQuery.sap.log.error("fnHandleDetailWindowVisibility","invalid sContext","MapsDataMarshal.js");}}else{jQuery.sap.log.error("fnHandleDetailWindowVisibility","invalid sMode","MapsDataMarshal.js");}};
splReusable.libs.MapsDataMarshal.prototype.fnCheckPointWithinGate=function(g,p){var G=g.length;var i;var m=[];for(i=0;i<G;i++){var o=JSON.parse(g[i]["GateGeometry"]);if(((o["coordinates"][0][0]===p["long"])&&(o["coordinates"][0][1]===p["lat"]))||((o["coordinates"][1][0]===p["long"])&&(o["coordinates"][1][1]===p["lat"]))){m.push(g[i]);}}return m;};
splReusable.libs.MapsDataMarshal.prototype.fnGetMapZoom=function(v,z){var i;var Z=JSON.parse(z.getParameter("data")).Action.AddActionProperties.AddActionProperty;var p=JSON.parse(z.getParameter("data")).Action.Params.Param;for(i=0;i<Z.length;i++){if(Z[i]["name"]==="zoom"){v.zoom=Z[i]["#"];}else if(Z[i]["name"]==="centerpoint"){v.centerpoint=Z[i]["#"];}}for(i=0;i<p.length;i++){if(p[i]["name"]==="min"){v.min=p[i]["#"];}else if(p[i]["name"]==="max"){v.max=p[i]["#"];}}if(v.max!==undefined&&v.min!==undefined){var t=v.min;var b=v.max;var a=t.split(";")[0]+";"+b.split(";")[1]+";0";var c=b.split(";")[0]+";"+t.split(";")[1]+";0";var d=t+";"+a+";"+b+";"+c;v.boundingRectangle=d;}};
splReusable.libs.MapsDataMarshal.prototype.fnGetMapCenter=function(v,z){var i;var Z=JSON.parse(z.getParameter("data")).Action.AddActionProperties.AddActionProperty;var p=JSON.parse(z.getParameter("data")).Action.Params.Param;for(i=0;i<Z.length;i++){if(Z[i]["name"]==="centerpoint"){v.centerpoint=Z[i]["#"];}}for(i=0;i<p.length;i++){if(p[i]["name"]==="min"){v.min=p[i]["#"];}else if(p[i]["name"]==="max"){v.max=p[i]["#"];}}if(v.max!==undefined&&v.min!==undefined){var t=v.min;var b=v.max;var a=t.split(";")[0]+";"+b.split(";")[1]+";0";var c=b.split(";")[0]+";"+t.split(";")[1]+";0";var d=t+";"+a+";"+b+";"+c;v.boundingRectangle=d;}};
splReusable.libs.MapsDataMarshal.prototype.fnSetZoomAndCenter=function(v,z){v.zoomToGeoPosition(z.lon,z.lat,z.zoomLevel);};
splReusable.libs.MapsDataMarshal.prototype.fnPanTo=function(v,p){var P=p.split(";");if(v.zoom){v.zoomToGeoPosition(parseFloat(P[0],10),parseFloat(P[1],10),parseFloat(v.zoom,10));}};
splReusable.libs.MapsDataMarshal.prototype.fnPanToEntity=function(v,r){var c;if(r["Geometry"]){c=this.convertGeoJSONToString(JSON.parse(r["Geometry"])).split(";");if(v.zoom){v.zoomToGeoPosition(parseFloat(c[0],10),parseFloat(c[1],10),parseFloat(v.zoom,10));}}else if(r["Position"]){c=this.convertGeoJSONToString(JSON.parse(r["Position"])).split(";");if(v.zoom){v.zoomToGeoPosition(parseFloat(c[0],10),parseFloat(c[1],10),parseFloat(v.zoom,10));}}else if(r["SourceLocation"]){c=this.convertGeoJSONToString(JSON.parse(r["SourceLocation"])).split(";");if(v.zoom){v.zoomToGeoPosition(parseFloat(c[0],10),parseFloat(c[1],10),parseFloat(v.zoom,10));}}else{jQuery.sap.log.error("fnPanToEntity","invalid entity","liveApp.controller.js");}};
splReusable.libs.MapsDataMarshal.prototype.plotOnVBMap=function(v,V){if(v&&V){v.load(V);}};
splReusable.libs.MapsDataMarshal.prototype.fnClearMap=function(v){var c=this.getMapsModelJSON(SapSplEnums.configJSON);if(v.centerpoint&&v.zoom){c.SAPVB.Scenes.Set.SceneGeo.initialStartPosition=v.centerpoint;c.SAPVB.Scenes.Set.SceneGeo.initialZoom=v.zoom;}v.load(c);if(v.zoom){var C=v.centerpoint.split(";");v.zoomToGeoPosition(parseFloat(C[0],10),parseFloat(C[1],10),parseFloat(v.zoom,10));}};
splReusable.libs.MapsDataMarshal.prototype.fnResetValues=function(v){if(v.aSelectedLocationFences!==undefined){v.aSelectedLocationFences=[];}if(v.aSelectedTrucks!==undefined){v.aSelectedTrucks=[];}this.aClickedPoints=[];this.aPolygonPoints=[];this.oFlagSkeleton.SAPVB.Data.Set.N.E.length=0;this.oPintOfInterestFlagSkeleton.SAPVB.Data.Set.N.E.length=0;this.oTruckFlagSkeleton.SAPVB.Data.Set.N.E.length=0;this.iClickCount=0;this.isMapClickEabled=false;this.isGeofenceSelectDeselectEnabled=true;this.sFirstClickPoint="";};
var oSapSplMapsDataMarshal=new splReusable.libs.MapsDataMarshal();
