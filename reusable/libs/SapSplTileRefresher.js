/*
 * Copyright (C) 2009-2015 SAP SE or an SAP affiliate company. All rights reserved.
 */
$.sap.declare("splReusable.libs.SapSplTileRefresher");var oSapSplTileRefresher={oTileModel:new sap.ui.model.json.JSONModel(),sPageId:"__tile0-splView.tileContainer.MasterTileContainer--masterTileContainerPage-",oContextObject:null,tileConfig:{"myBusinessPartners":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":"/MyBusinessPartners/$count/?$filter=(BasicInfo_Type eq 'O' and isOwner ne 1)","secondaryService":"/MyBusinessPartners/$count/?$filter=((RequestStatus ne '1' or Status ne '1') and isOwner ne 1)"},"tileScale":oSapSplUtils.getBundle().getText("CONNECTIONS_LABEL_BUPA_TILE")},"myUsers":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":"/MyUsers/$count/?$filter=(BasicInfo_Type eq 'P' and isMyself ne 1)","secondaryService":"/MyUsers/$count/?$filter=(RequestStatus ne '1' and isMyself ne 1)"},"tileScale":oSapSplUtils.getBundle().getText("USERS_LABEL_USERS_TILE")},"vehicles":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("FILTER_LABEL_ACTIVE"),"tileService":{"primaryService":"/MyTrackableObjects/$count/?$filter=(Status eq 'A') and isDeleted eq '0' and isSharedWithMyOrg eq 0","secondaryService":"/MyTrackableObjects/$count/?$filter=(Status eq 'I') and isDeleted eq '0' and isSharedWithMyOrg eq 0","secondaryService1":"/MyTrackableObjects/$count/?$filter=isDeleted eq '0' and isSharedWithMyOrg eq 0"},"tileScale":oSapSplUtils.getBundle().getText("INACTIVE_TRUCKS_TRACKABLEOBJECTS_TILE"),"tileScale1":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT")},"manageTours":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("FILTER_LABEL_ACTIVE"),"tileService":{"primaryService":"/Tours/$count?$filter=(TourStatus eq 'S') or (TourStatus eq 'A') or (TourStatus eq 'L') or (TourStatus eq 'I')","secondaryService":"/Tours/$count/?$filter=(TourStatus eq 'U')"},"tileScale":oSapSplUtils.getBundle().getText("TOURS_COUNT_TOURS_TILE")},"incidences":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("INCIDENTS_CATEGORY_CONTAINER"),"tileService":{"primaryService":"/IncidentDetails/$count/?$filter=(isDeleted eq '0') and (Category eq 'C')","secondaryService":"/IncidentDetails/$count/?$filter=(isDeleted eq '0') and (Category eq 'I')","secondaryService1":"/IncidentDetails/$count/?$filter=(isDeleted eq '0') and (Category eq 'P')"},"tileScale":oSapSplUtils.getBundle().getText("INCIDENTS_CATEGORY_INTERFERENCE"),"tileScale1":oSapSplUtils.getBundle().getText("INCIDENTS_CATEGORY_PARKING")},"liveApp":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":"/OccurredIncidents/$count","secondaryService":"/OccurredIncidents/$count/?$filter=(Priority eq '1')"},"tileScale":oSapSplUtils.getBundle().getText("PRIORITY_LABEL_LIVEAPP_TILE")},"reporting":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":"","secondaryService":""},"tileScale":null},"help":{"tileSize":"L","frameType":"TwoByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":"./resources/icons/tile_help_image.jpg","tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":null,"secondaryService":null},"tileScale":null},"userNotification":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":"/MyFeed/$count/?$filter=(isNotification eq '1')","secondaryService":"/MyFeed/$count/?$filter=(isNotification eq '1' and isActive eq '1')"},"tileScale":oSapSplUtils.getBundle().getText("USER_NOTIFICATION_ACTIVE_LABEL")},"usageLog":{"tileSize":"L","frameType":"TwoByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":"./resources/icons/tile_help_image.jpg","tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":null,"secondaryService":null},"tileScale":null},"communicationLog":{"tileSize":"L","frameType":"OneByOne","tileHeader":null,"tileSubheader":null,"tileBGImage":null,"tileTotalCountText":oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT"),"tileService":{"primaryService":null,"secondaryService":null},"tileScale":null}},resultVisualizerFactory:function(e,p,c,m,a){if(e==="myBusinessPartners"){oSapSplTileRefresher.buPaResultVisualizer(p,m,c,a,this.tileConfig["myBusinessPartners"]);}else if(e==="myUsers"){oSapSplTileRefresher.usersResultVisualizer(p,m,c,a,this.tileConfig["myUsers"]);}else if(e==="vehicles"){oSapSplTileRefresher.trackableObjectResultVisualizer(p,m,c,a,this.tileConfig["vehicles"]);}else if(e==="manageTours"){oSapSplTileRefresher.manageToursResultVisualizer(p,m,c,a,this.tileConfig["manageTours"]);}else if(e==="incidences"){oSapSplTileRefresher.manageIncidentsResultVisualizer(p,m,c,a,this.tileConfig["incidences"]);}else if(e==="liveApp"){oSapSplTileRefresher.liveAppResultVisualizer(p,m,c,a,this.tileConfig["liveApp"]);}else if(e==="reporting"){oSapSplTileRefresher.reportResultVisualizer(p,m,c,a,this.tileConfig["reporting"]);}else if(e==="help"){oSapSplTileRefresher.helpResultVisualizer(p,m,c,a,this.tileConfig["help"]);}else if(e==="userNotification"){oSapSplTileRefresher.userNotificationResultVisualizer(p,m,c,a,this.tileConfig["userNotification"]);}else if(e==="usageLog"){oSapSplTileRefresher.manageUsageLogVisualizer(p,m,c,a,this.tileConfig["usageLog"]);}else if(e==="communicationLog"){oSapSplTileRefresher.communicationLogVisualizer(p,m,c,a,this.tileConfig["communicationLog"]);}else{sap.ui.getCore().byId(p+c).setProperty("state",SapSplEnums.TILESTATELOADED);m.refresh();}},refreshAllTiles:function(){for(var c=0;c<this.oTileModel.getData().results.length;c++){if(this.oTileModel.getData().results[c].hasOwnProperty("count")){sap.ui.getCore().byId(this.sPageId+this.oTileModel.getData().results[c].count).setProperty("state",SapSplEnums.TILESTATELOADING);}oSapSplTileRefresher.resultVisualizerFactory(this.oTileModel.getData().results[c].AppID,this.sPageId,c,this.oTileModel,this.oTileModel.getData().results[c]);}},refreshTiles:function(e){var c=0;function g(m){for(var i=0;i<m.getData().results.length;i++){if(m.getData().results[i].AppID===e){c=i;break;}}}g(this.oTileModel);if(!e||e===null){this.oTileModel.refresh();}if(this.oTileModel.getData().results[c].hasOwnProperty("count")){sap.ui.getCore().byId(this.sPageId+this.oTileModel.getData().results[c].count).setProperty("state",SapSplEnums.TILESTATELOADING);}this.resultVisualizerFactory(e,this.sPageId,c,this.oTileModel,this.oTileModel.getData().results[c]);},buPaResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("size",t["tileSize"]).setProperty("frameType",t["frameType"]).setProperty("state",SapSplEnums.TILESTATELOADED);$.sap.log.info("Rendering of BuPa results completed successfully","BuPa Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"BuPa Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"BuPa Result visualizer","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},manageToursResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(2);sap.ui.getCore().byId(p+c).removeTileContent(0);}sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);sap.ui.getCore().byId(p+C.count).getTileContent()[0].getContent().setProperty("colorPalette",["#61a656","#d32030"]);$.sap.log.info("Rendering of Manage Tours results completed successfully","Manage Tours Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"Manage Tours Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"Manage Tours Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});},usersResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("size",t["tileSize"]);sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);$.sap.log.info("Rendering of Users results completed successfully","Users Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"Users Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"Users Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},userNotificationResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("size",t["tileSize"]);sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);$.sap.log.info("Rendering of User Notificatins results completed successfully","User Notificatins Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"User Notificatins Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"User Notificatins Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},manageIncidentsResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(0);sap.ui.getCore().byId(p+c).removeTileContent(0);}sap.ui.getCore().byId(p+C.count).getTileContent()[0].getContent().setProperty("colorPalette",["#5cbae6","#fac364","#b6d957"]);$.sap.log.info("Rendering of Manage Incidents results completed successfully","Manage Incidents Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"Manage Incidents Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"Manage Incidents Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService1"],c,t["tileScale1"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"Manage Incidents Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});},liveAppResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);$.sap.log.info("Rendering of Live App results completed successfully","Live App Result visualizer","SAPSCL");},function(e,C){$.sap.log.error("Error: "+e.toString(),"Live App Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){$.sap.log.error("Error: "+e.toString(),"Live App Result visualizer error","SAPSCL");m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},reportResultVisualizer:function(p,m,c,a,t){$.sap.log.info("SAP SCL Report Result visualizer","Tile configuration "+t.toString(),"SAPSCL");sap.ui.getCore().byId(p+c).setProperty("state",SapSplEnums.TILESTATELOADED);a.state=SapSplEnums.TILESTATELOADED;m.refresh();},helpResultVisualizer:function(p,m,c,C,t){sap.ui.getCore().byId(p+c).addStyleClass("sapSplHelpTile");sap.ui.getCore().byId(p+c).setProperty("frameType",t["frameType"]);sap.ui.getCore().byId(p+c).setProperty("state",SapSplEnums.TILESTATELOADED);sap.ui.getCore().byId(p+c).setHeader(t["tileHeader"]);sap.ui.getCore().byId(p+c).setProperty("subheader",t["tileSubHeader"]);sap.ui.getCore().byId(p+c).removeTileContent(0);sap.ui.getCore().byId(p+c).setProperty("backgroundImage",t["tileBGImage"]);sap.ui.getCore().byId(p+c).addTileContent(new sap.suite.ui.commons.TileContent({content:new sap.suite.ui.commons.NewsContent({contentText:oSapSplUtils.getBundle().getText("SPL_HELPTILE_DESCRIPTION")})}));sap.ui.getCore().byId(p+c).removeTileContent(0);sap.ui.getCore().byId(p+c).removeTileContent(0);C.state=SapSplEnums.TILESTATELOADED;m.refresh();},manageUsageLogVisualizer:function(p,m,c,C){sap.ui.getCore().byId(p+c).setProperty("state",SapSplEnums.TILESTATELOADED);C.state=SapSplEnums.TILESTATELOADED;m.refresh();if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},communicationLogVisualizer:function(p,m,c,C){sap.ui.getCore().byId(p+c).setProperty("state",SapSplEnums.TILESTATELOADED);C.state=SapSplEnums.TILESTATELOADED;m.refresh();if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(1);sap.ui.getCore().byId(p+c).removeTileContent(1);}},trackableObjectResultVisualizer:function(p,m,c,a,t){this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["primaryService"],c,null,t["tileTotalCountText"],a,function(r,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("frameType",t["frameType"]);if(sap.ui.getCore().byId(p+c).getTileContent().length>1){sap.ui.getCore().byId(p+c).removeTileContent(0);sap.ui.getCore().byId(p+c).removeTileContent(0);}sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATELOADED);sap.ui.getCore().byId(p+C.count).getTileContent()[0].getContent().setProperty("colorPalette",["#61a656","#d32030","848f94"]);$.sap.log.info("Rendering of Trucks results completed successfully","Trucks Result visualizer","SAPSCL");},function(e,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService"],c,t["tileScale"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});this.getFilteredValue(oSapSplUtils.getServiceMetadata("app",true)+t["tileService"]["secondaryService1"],c,t["tileScale1"],t["tileTotalCountText"],a,function(){m.refresh();},function(e,C){m.refresh();sap.ui.getCore().byId(p+C.count).setProperty("state",SapSplEnums.TILESTATEFAILED);});},getFilteredValue:function(u,c,s,t,C,a,e){$.ajax({url:u,method:"GET",dataType:"json",context:C,success:function(r){this.state=SapSplEnums.TILESTATELOADED;this.count=c;this.totalText=t;if(s===null){this.result=r;}if(s===oSapSplUtils.getBundle().getText("INCIDENTS_CATEGORY_PARKING")||s===oSapSplUtils.getBundle().getText("SPL_TOTAL_COUNT_TEXT")){this.scaleText1=s;this.scaleCount1=r;}else if(s!==null){this.scale=r+"\t"+s;this.scaleText=s;this.scaleCount=r;}a(r,C);},error:function(x,b,d){C.count=c;e(x,C,b,d);}});}};
