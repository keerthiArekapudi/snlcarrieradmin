/*
 * Copyright (C) 2009-2015 SAP SE or an SAP affiliate company. All rights reserved.
 */
jQuery.sap.declare("splReusable.libs.Utils");jQuery.sap.require("splReusable.exceptions.MissingParametersException");jQuery.sap.require("splReusable.exceptions.InvalidArrayException");jQuery.sap.require("splReusable.libs.SapSplEnums");jQuery.sap.require("jquery.sap.storage");
splReusable.libs.Utils=function(){this.aUUID=[];this.oSapSplUUIDModel=null;this.oSplitAppBaseOne=null;this.oSplitAppBaseTwo=null;this.oSplitAppBaseVehicle=null;this.aListOfUnAssignedDevices=[];this.oSapSplMapFilterControl=null;this.oSapSplLoggedInUsersCompanyDetails=null;this.oSapSplInitializerDetails=null;this.oSapSplLoggedOnUserDetails=null;this.aAllowedTiles=[];this.aIntervalIds=[];this.oAppToLoad={};this.oSapSplCore=sap.ui.getCore();this.bStartupError=false;this.sLO4S="nav";this.startDate=null;this.sSystemType=null;this.bIsInHCBMode=false;this.sReferrer=null;this.sHelpType="html";this.isNavToAppComplete=false;this.oCurrentAppInfo={};this.oSplL10NBundle=jQuery.sap.resources({url:"./resources/l10n/label.properties",locale:sap.ui.getCore().getConfiguration().getLanguage()});if(!sap.ui.getCore().getModel("splI18NModel")){sap.ui.getCore().setModel(new sap.ui.model.resource.ResourceModel({bundleUrl:"./resources/l10n/label.properties",bundleLocale:sap.ui.getCore().getConfiguration().getLocale().getLanguage(),async:true}),"splI18NModel");}if(!sap.ui.getCore().getModel("myCompanyDetails")){sap.ui.getCore().setModel(new sap.ui.model.json.JSONModel(),"myCompanyDetails");}this.oSplQueryParametersMap={};this.oSapSplMessageBundleFactory={resourceBundleObject:null,getResourceInstance:function(p){if(this.oSapSplMessageBundleFactory.resourceBundleObject===null){this.oSapSplMessageBundleFactory.resourceBundleObject={};this.oSapSplMessageBundleFactory.resourceBundleObject[p]=$.sap.resources({url:p,locale:sap.ui.getCore().getConfiguration().getLanguage()});}else{if(!this.oSapSplMessageBundleFactory.resourceBundleObject.hasOwnProperty(p)){this.oSapSplMessageBundleFactory.resourceBundleObject[p]=$.sap.resources({url:p,locale:sap.ui.getCore().getConfiguration().getLanguage()});}}return this.oSapSplMessageBundleFactory.resourceBundleObject[p];}.bind(this)};this.isPageDirty=false;this.errorMessageMapper={errorMessages:[{iName:"Organization.Name",eName:this.getBundle().getText("ORGANIZATION_NAME_FIELD")},{iName:"CommunicationInfo.EmailAddress",eName:this.getBundle().getText("EMAIL_ADDRESS_FIELD")},{iName:"CommunicationInfo.Phone",eName:this.getBundle().getText("PHONE")},{iName:"CommunicationInfo.Fax",eName:this.getBundle().getText("FAX")},{iName:"PersonName.Surname",eName:this.getBundle().getText("PERSON_SURNAME_FIELD")},{iName:"PersonName.GivenName",eName:this.getBundle().getText("PERSON_GIVENNAME_FIELD")},{iName:"RegistrationNumber",eName:this.getBundle().getText("VEHICLE_REGISTRATION_NUMBER")},{iName:"LocationSpecName",eName:this.getBundle().getText("LOCATION_NAME_NOT_EMPTY")},{iName:"IncidentCode",eName:this.getBundle().getText("INCIDENTS_NAME")},{iName:"LongText",eName:this.getBundle().getText("INCIDENTS_MESSAGE")},{iName:"EventCode",eName:this.getBundle().getText("INCIDENTS_CATEGORY")},{iName:"Priority",eName:this.getBundle().getText("INCIDENTS_PRIORITY")},{iName:"PolygonSpec",eName:this.getBundle().getText("INCIDENTS_LOCATION")},{iName:"UniqueID",eName:this.getBundle().getText("DEVICE_ID")},{iName:"Category",eName:this.getBundle().getText("INCIDENTS_CATEGORY")},{iName:"Priority",eName:this.getBundle().getText("INCIDENTS_PRIORITY")},{iName:"Name",eName:this.getBundle().getText("INCIDENTS_NAME")},{iName:"Address.Name1",eName:this.getBundle().getText("NEW_LOCATION_ADDRESS_FIELD_TITLE",1)},{iName:"Address.Town",eName:this.getBundle().getText("NEW_LOCATION_CITY_LABEL")},{iName:"BuildingID",eName:this.getBundle().getText("NEW_LOCATION_ADDRESS_FIELD_TITLE",["1"])},{iName:"ObjectUUID",eName:this.getBundle().getText("OBJECT_LOCATION_CODE")},{iName:"StreetName",eName:this.getBundle().getText("NEW_LOCATION_ADDRESS_FIELD_TITLE",["2"])},{iName:"CityName",eName:this.getBundle().getText("NEW_LOCATION_CITY_LABEL")},{iName:"StreetPostalCode",eName:this.getBundle().getText("NEW_LOCATION_ZIPCODE_LABEL")},{iName:"RegionName",eName:this.getBundle().getText("NEW_LOCATION_REGION_LABEL")},{iName:"CountryName",eName:this.getBundle().getText("NEW_LOCATION_COUNRTY_LABEL")},{iName:"Capacity",eName:this.getBundle().getText("CAPACITY_PARKING_SPACE_LABEL")},{iName:"LocationUUID",eName:this.getBundle().getText("STOP_DETAILS")}]};this.helpLinkMapper={helpLinks:[{appId:"myBusinessPartners",iLink:"",eLink:""},{appId:"myUsers",iLink:"",eLink:""},{appId:"manageTours",iLink:"",eLink:""},{appId:"incidences",iLink:"",eLink:""},{appId:"vehicles",iLink:"",eLink:""},{appId:"liveApp",iLink:"",eLink:""},{appId:"reporting",iLink:"",eLink:""}]};};
splReusable.libs.Utils.prototype.setSplitAppBaseVehicle=function(b){try{if(b&&typeof b==="object"){this.oSplitAppBaseVehicle=b.byId("SapSplVehicleMasterDetailSplitApp");}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of setSplitAppBaseVehicle function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentDetailPageVehicle=function(){try{if(this.oSplitAppBaseVehicle.getCurrentDetailPage()){return this.oSplitAppBaseVehicle.getCurrentDetailPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentDetailPageVehicle function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentMasterPageVehicle=function(){try{if(this.oSplitAppBaseVehicle.getCurrentMasterPage()){return this.oSplitAppBaseVehicle.getCurrentMasterPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentMasterPageVehicle function call","Utils.js");}}};
splReusable.libs.Utils.prototype.setSplitAppBaseOne=function(b){try{if(b&&typeof b==="object"){this.oSplitAppBaseOne=b.byId("SplitAppBase");}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of setSplitAppBaseOne function call","Utils.js");}}};
splReusable.libs.Utils.prototype.setCompanyDetails=function(c){try{if(c&&typeof c==="object"){this.oSapSplLoggedInUsersCompanyDetails=c;if(sap.ui.getCore().getModel("myCompanyDetails")){sap.ui.getCore().getModel("myCompanyDetails").setData(c);}}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of setCompanyDetails function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCompanyDetails=function(){try{if(this.oSapSplLoggedInUsersCompanyDetails){return this.oSapSplLoggedInUsersCompanyDetails;}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCompanyDetails function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentMasterPage=function(){try{if(this.oSplitAppBaseOne.getCurrentMasterPage()){return this.oSplitAppBaseOne.getCurrentMasterPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentMasterPage function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentDetailPage=function(){try{if(this.oSplitAppBaseOne.getCurrentDetailPage()){return this.oSplitAppBaseOne.getCurrentDetailPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentDetailPage function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getQueryParameterValues=function(p){try{if(p&&p.length>0){jQuery.sap.log.info("Parameters passed. Valid arguement");}}catch(e){jQuery.sap.log.error(e.message,"Failure of getQueryParameterValues function call","Utils.js");}};
splReusable.libs.Utils.prototype.getBundle=function(){return this.oSplL10NBundle;};
splReusable.libs.Utils.prototype.getBusinessMessageBundle=function(){return this.oSplL10NBundle;};
splReusable.libs.Utils.prototype.getFQServiceUrl=function(s){var o=null;try{if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");}if(this.getReferrer().indexOf(window.location.hostname)===-1){throw new Error("Invalid usage.Origin and service host do not match");}if(s&&s!==null&&typeof(s)==="string"){var p=new RegExp("localhost","gi");var r=p.exec(window.location.hostname);if(r!==null&&window.location.hostname===r[0]){if(s.charAt(0)!=="/"){s="proxy/"+s;}else{s="proxy"+s;}}else{if(s.charAt(0)!=="/"){s=window["location"]["origin"]+"/"+s;}else{s=window["location"]["origin"]+s;}}}else{throw new splReusable.exceptions.MissingParametersException({source:this.toString(),message:"serviceUrl argument missing",options:{severity:"Information"}});}}catch(e){if(e.constructor===splReusable.exceptions.MissingParametersException){jQuery.sap.log.error(e.message,"Failure of getFQServiceUrl function call","Utils.js");}}return s;};
splReusable.libs.Utils.prototype.setServiceMetadata=function(s){this.oServiceUrls=s;};
splReusable.libs.Utils.prototype.getServiceMetadata=function(s,g){try{var _=null;if(s!==undefined&&s!==null){if(s.constructor===String){for(var i=0;i<this.oServiceUrls.services.length;i++){if(g){if(this.oServiceUrls.services[i].id===s){_=this.getFQServiceUrl(this.oServiceUrls.services[i]["value"]);}}else{if(this.oServiceUrls.services[i].id===s){_=this.oServiceUrls.services[i];}}}return _;}else{throw new TypeError();}}else{throw new ReferenceError();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getServiceMetadata function call","Utils.js");}}};
splReusable.libs.Utils.prototype.validateEmailID=function(e){if(typeof(e)==="object"){var a="";if(e["pattern"]!==undefined){a=e["pattern"];}else{a=/^([a-zA-Z0-9]+[a-zA-Z0-9._%-]*@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4})$/;}var b=a.test(e["email"]);return b;}else{throw new TypeError();}};
splReusable.libs.Utils.prototype.getResolvedEntityNameForNavigation=function(s,a){var r=null;try{if(arguments===undefined||arguments.length<0){throw new splReusable.exceptions.MissingParametersException({message:SapSplEnums.missing_parameter,source:this.toString(),options:{severity:SapSplEnums.fatal}});}else{if(s){if(a===undefined||a===null){a="appl";}r=s.split(this.getODataServiceUrl(a))[1];}}}catch(e){if(e.constructor===splReusable.exceptions.MissingParametersException){jQuery.sap.log.error(e.message,"Failure of getResolvedEntityNameForNavigation function call","Utils.js");}}return"/"+r;};
splReusable.libs.Utils.prototype.getUUID=function(){splReusable.libs.SplTracer.trace(0,"getUUID in Utils");var u=null;if(this.aUUID.length<=0){this.fetchUUIDs(false);}else if(this.aUUID.length<=10){this.fetchUUIDs(true);}for(var t=0,T=this.aUUID.length;t<T;t++){var _=this.aUUID.pop().UUID;u=_;break;}splReusable.libs.SplTracer.trace(1,"getUUID in Utils");return u;};
function maintainArrayOfUUID(d,t,X){$.sap.log.info("SAP SCL Utils","Text Status: "+t+" XHR: "+X,"SAPSCL");var r=d;for(var U=1;U<r.results.length;U++){this.aUUID.push(r.results[U]);}}
splReusable.libs.Utils.prototype.fetchUUIDs=function(a){var t=this;if(!sap.ui.getCore().getModel("sapSplUtilsModel")){sap.ui.getCore().setModel(new splModels.odata.ODataModel({url:t.getServiceMetadata("utils",true),json:true,headers:{"Cache-Control":"max-age=0"},tokenHandling:true,withCredentials:false,loadMetadataAsync:true,handleTimeOut:true,numberOfSecondsBeforeTimeOut:10000}),"sapSplUtilsModel");}sap.ui.getCore().getModel("sapSplUtilsModel").read("/UUID",{async:(function(){if(a===undefined){return true;}return a;}()),success:function(r){maintainArrayOfUUID.call(t,r);},error:function(e){jQuery.sap.log.error("UUID fetch failed: "+e.toString());}});};
splReusable.libs.Utils.prototype.setCSRFToken=function(S){try{if(!this.SapSplCSRFToken){this.SapSplCSRFToken=S;}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error("Failure of setCSRFToken function call","Perhaps due to missing CSRF setting. POST actions might fail","splReusable.libs.Utils.setCSRFToken()");}}};
splReusable.libs.Utils.prototype.getCSRFToken=function(){try{if(this.SapSplCSRFToken){return this.SapSplCSRFToken;}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCSRFToken function call","Utils.js");}}};
splReusable.libs.Utils.prototype.failureOfUUIDFetch=function(){};
splReusable.libs.Utils.prototype.setSplitAppBaseTwo=function(b){try{if(b&&typeof b==="object"){this.oSplitAppBaseTwo=b.byId("SplitAppBaseBusinessPartners");}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of setSplitAppBaseTwo function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentMasterPageBP=function(){try{if(this.oSplitAppBaseTwo.getCurrentMasterPage()){return this.oSplitAppBaseTwo.getCurrentMasterPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentMasterPageBP function call","Utils.js");}}};
splReusable.libs.Utils.prototype.getCurrentDetailPageBP=function(){try{if(this.oSplitAppBaseTwo.getCurrentDetailPage()){return this.oSplitAppBaseTwo.getCurrentDetailPage();}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Failure of getCurrentDetailPageBP function call","Utils.js");}}};
splReusable.libs.Utils.prototype.IsValidArray=function(a){if(arguments&&arguments.length<0){throw new splReusable.exceptions.MissingParametersException({message:"Invalid arguments passed",source:this.toString(),options:{severity:SapSplEnums.fatal}});}else{if(a.hasOwnProperty("length")&&typeof a.length==="number"){return true;}else{return false;}}};
splReusable.libs.Utils.prototype.getErrorMessagesfromErrorPayload=function(e){var _={"errors":[]},a=null,b=null,r={completeErrorObject:null,ufErrorObject:null,errorWarningString:null,messageTitle:{title:null,valueState:null}};if(arguments===undefined||arguments.length<=0){throw new splReusable.exceptions.MissingParametersException({message:"Missing arguments. Invalid usage",source:this.toString(),options:{severity:SapSplEnums.fatal}});}function c(p){return p.split(".").join("/")+"/";}function d(j){var k=[],l=false,t={};for(var m=0,C=j.errors.length;m<C;m++){jQuery.each(j.errors[m]["UFLocation"],function(K,v){k.push(v+" : "+j.errors[m]["Message"]["UFMessage"]);l=true;});if(l){l=false;continue;}if(t[j.errors[m]["Message"]["UFMessage"]]!==true){k.push(j.errors[m]["Message"]["UFMessage"]);t[j.errors[m]["Message"]["UFMessage"]]=true;}}return k.join("\n");}function f(s){for(var j=0,C=this.errorMessageMapper.errorMessages.length;j<C;j++){for(var k=0,l=s.length;k<l;k++){if(s[k]===this.errorMessageMapper.errorMessages[j]["iName"]){b["UFLocation"][this.errorMessageMapper.errorMessages[j]["iName"]]=this.errorMessageMapper.errorMessages[j]["eName"];break;}}}}function g(_){var j=0,k=0,l="";if(this.IsValidArray(_.errors)){for(var m=0,C=_.errors.length;m<C;m++){if(_.errors[m]["Severity"]==="E"){j++;}else if(_.errors[m]["Severity"]==="W"){k++;}}l=this.getBundle().getText("IDENTIFIED_ERRORS_AND_WARNINGS",[j,k]);}else{l=this.getBundle().getText("MALFORMED_ERROR_OBJECT");}return{value:l,count:j+k,errorCount:j,warningCount:k};}function h(o){var j=g.call(this,o);var k=j["errorCount"];var w=j["warningCount"];r["completeErrorObject"]=o;r["ufErrorObject"]=d(o);if(k>0&&w===0){r["errorWarningString"]=this.getBundle().getText("SPL_ERROR_MESSAGE");r["messageTitle"]["title"]=this.getBundle().getText("SPL_ERROR_DIALOG_HEADER");r["messageTitle"]["valueState"]="Error";}else if(k===0&&w>0){r["errorWarningString"]=this.getBundle().getText("SPL_WARNING_MESSAGE");r["messageTitle"]["title"]=this.getBundle().getText("SPL_WARNING_DIALOG_HEADER");r["messageTitle"]["valueState"]=sap.ui.core.ValueState.Warning;}else if(k>0&&w>0){r["errorWarningString"]=this.getBundle().getText("SPL_ERROR_WARNING_MESSAGE");r["messageTitle"]["title"]=this.getBundle().getText("SPL_ERROR_WARNING_DIALOG_HEADER");r["messageTitle"]["valueState"]="None";}else{return r;}return r;}if(e.hasOwnProperty("Error")){if(e.Error.length>0){var i=e.Error;for(var E=0,C=i.length;E<C;E++){b={"Severity":null,"ObjectType":null,"Entity":null,"Keys":{"UUID":null},"Message":{"Package":null,"Bundle":null,"ID":null},"Location":[],"UFLocation":{},"TextSubstitutionValues":null,"Text":null};b.Severity=i[E]["Severity"];b.ObjectType=i[E]["ObjectType"];b.Entity=i[E]["Entity"];b.Location=i[E]["Location"];b["Keys"]["UUID"]=i[E]["Keys"]["UUID"];b["Message"]["Package"]=i[E]["Message"]["Package"];b["Message"]["Bundle"]=i[E]["Message"]["Bundle"];b["Message"]["ID"]=i[E]["Message"]["ID"];b["TextSubstitutionValues"]=i[E]["TextSubstitutionValues"];b["Text"]=i[E]["Text"];if((i[E]["TextSubstitutionValues"]&&i[E]["TextSubstitutionValues"]!==null)&&i[E]["TextSubstitutionValues"].hasOwnProperty("length")&&i[E]["TextSubstitutionValues"].length>0){a=i[E]["TextSubstitutionValues"];}b["Message"]["UFMessage"]=this.oSapSplMessageBundleFactory.getResourceInstance(this.getFQServiceUrl(c(b["Message"]["Package"])+b["Message"]["Bundle"]+".hdbtextbundle")).getText(b["Message"]["ID"],a);f.call(this,b["Location"]);_.errors.push(b);}}else{jQuery.sap.log.error("Error message payload","Invalid error object format","splReusable.libs.Utils.getErrorMessageFromErrorPayload");}}else{jQuery.sap.log.error("Error message paylaod","Missing Error/Message field on payload","splReusable.libs.Utils.getErrorMessagesfromErrorPayload");}jQuery.sap.log.info("Error message object","Message object prepared with detailed information","splReusable.libs.Utils");return h.call(this,_);};
splReusable.libs.Utils.prototype.isObjectEmpty=function(o){if(arguments===undefined||arguments===null||arguments.length<=0){throw new splReusable.exceptions.MissingParametersException({message:"Invalid usage",source:this.toString(),options:{severity:SapSplEnums.fatal}});}if(o.constructor!==Object){throw new TypeError();}try{if(o.constructor===Object){for(var k in o){if(o.hasOwnProperty(k)){return false;}}return true;}else{throw new Error();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"oObject is not an object - isObjectEmpty","Utils.js");}}};
splReusable.libs.Utils.prototype.updateUnAssignedDevices=function(a,o){var m=null,d=[],f=null,M=[],O=[],D="";m=sap.ui.getCore().getModel("myVehiclesAddVehicleModel").getData();if(a===undefined||a.constructor!==Boolean){a=true;}if(sap.ui.getCore().getModel("myVehiclesAddVehicleModel")){jQuery.ajax({url:this.getFQServiceUrl("/sap/spl/xs/appl/services/appl.xsodata/")+"MyUnAssignedDevices?$format=json",async:a,json:true,success:function(b){d=b.d.results;for(var i=0;i<d.length;i++){if(d[i].DeviceType==="M"){M.push(d[i]);}else if(d[i].DeviceType==="O"){O.push(d[i]);}}if(d&&d.constructor===Array&&m.constructor===Object){if(o&&o.constructor===Object){D=o["DeviceType"];if(D&&D==="M"){if(M.length>0){f=d[0];M[0]=o;}else{f=o;}M[M.length]=f;}else if(D&&D==="O"){if(O.length>0){f=d[0];O[0]=o;}else{f=o;}O[O.length]=f;}else{if(M.length>0){f=d[0];M[0]=o;}else{f=o;}M[M.length]=f;}}m["devices"]=d;m["mobileDevices"]=M;m["obuDevices"]=O;sap.ui.getCore().getModel("myVehiclesAddVehicleModel").setData(m);}},error:function(){jQuery.sap.log.error("error in fetching unassigned devices","service for unassigned devices is down - updateUnAssignedDevices","Utils.js");}});}};
splReusable.libs.Utils.prototype.setSplModelFilterControlInstance=function(i){this.oSapSplMapFilterControl=i;};
splReusable.libs.Utils.prototype.getSplModelFilterControlInstance=function(){return this.oSapSplMapFilterControl;};
splReusable.libs.Utils.prototype.showMessage=function(m){if(arguments===undefined||arguments.length<=0){throw new splReusable.exceptions.MissingParametersException({message:"Missing arguments. showMessage",source:this.toString(),options:{severity:SapSplEnums.fatal}});}try{if(m.constructor===Object){sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:m.message,details:m.details});}else{throw new TypeError();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"oMessageBoxSettings is not an object - oMessageBoxSettings","Utils.js");}}};
splReusable.libs.Utils.prototype.setAllowedTilesList=function(a){if(arguments&&this.IsValidArray(arguments)){if(this.IsValidArray(a)){this.aAllowedTiles=a;}else{throw splReusable.exceptions.InvalidArrayException({message:"Invalid array object",source:"setAllowedTilesList",options:{severity:SapSplEnums.fatal}});}}else{throw splReusable.exceptions.MissingParametersException({message:"Missing arguments",source:"setAllowedTilesList",options:{severity:SapSplEnums.fatal}});}return this;};
splReusable.libs.Utils.prototype.getAllowedTilesList=function(){return(this.aAllowedTiles&&this.aAllowedTiles.length>0)?this.aAllowedTiles:null;};
splReusable.libs.Utils.prototype.checkAppPermission=function(a){var I=false,A=this.getAllowedTilesList();for(var i=0,j=A.length;i<j;i++){if(A[i]["AppID"]===a){I=true;this.setAppToLoad(A[i]);break;}}return I;};
splReusable.libs.Utils.prototype.setAppToLoad=function(a){this.oAppToLoad=a;};
splReusable.libs.Utils.prototype.getAppToLoad=function(){return this.oAppToLoad;};
splReusable.libs.Utils.prototype.showHeaderButton=function(s){if(arguments.length===0||arguments===undefined||arguments===null){throw new splReusable.exceptions.MissingParametersException({message:"Missing parameters to showHeaderButton",source:this.toString(),options:{severity:SapSplEnums.fatal}});}if(sap.ui.getCore().byId("sapSplBaseUnifiedShell").getHeadItems().length===0){if(s.hasOwnProperty("showButton")&&s.showButton){sap.ui.getCore().byId("sapSplBaseUnifiedShell").addHeadItem(new sap.ui.unified.ShellHeadItem({icon:(s.hasOwnProperty("navIcon")?s.navIcon:"sap-icon://home"),tooltip:this.getBundle().getText("UNIFIED_SHELL_HEADER_HOME"),press:function(){oSplBaseApplication.getAppInstance().to((s.hasOwnProperty("sNavToPage")?s.sNavToPage:"splView.tileContainer.MasterTileContainer"));}}));}}};
splReusable.libs.Utils.prototype.showDataLossWarningDialog=function(s){var i=false;if(oSplBaseApplication.getAppInstance().getCurrentPage().sId&&oSplBaseApplication.getAppInstance().getCurrentPage().sId==="splView.registeration.SplitAppBase"){if(this.getCurrentDetailPage().sId&&this.getCurrentDetailPage().sId==="NewContactRegistrationDetail"){if(sap.ui.getCore().getModel("myContactsRegisterEditModel").getData()&&sap.ui.getCore().getModel("myContactsRegisterEditModel").getData().ChangedFlag){i=true;this.showMessageBox(s);}}}if(oSplBaseApplication.getAppInstance().getCurrentPage().sId&&oSplBaseApplication.getAppInstance().getCurrentPage().sId==="splView.registeration.SplitAppBaseBusinessPartners"){if(this.getCurrentDetailPageBP().sId&&this.getCurrentDetailPageBP().sId==="NewBusinessPartnerRegistrationDetail"){if(sap.ui.getCore().getModel("myBusinessPartnerRegisterEditModel").getData()&&sap.ui.getCore().getModel("myBusinessPartnerRegisterEditModel").getData().ChangedFlag){i=true;this.showMessageBox(s);}}}if(oSplBaseApplication.getAppInstance().getCurrentPage().sId&&oSplBaseApplication.getAppInstance().getCurrentPage().sId==="splView.vehicles.VehicleMasterDetail"){if(this.getCurrentDetailPageVehicle().sId&&this.getCurrentDetailPageVehicle().sId==="MyVehiclesDetailAddVehicle"){if(sap.ui.getCore().getModel("myVehiclesAddVehicleModel").getData()&&sap.ui.getCore().getModel("myVehiclesAddVehicleModel").getData().ChangedFlag){i=true;this.showMessageBox(s);}}}return i;};
splReusable.libs.Utils.prototype.getListCount=function(m){try{var _=0;if(m&&m.getBinding("items")&&m.getBinding("items").iLength){_=m.getBinding("items").iLength;}return _;}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"oObject is not an object - isObjectEmpty","Utils.js");}}};
splReusable.libs.Utils.prototype.showMessageBox=function(s){sap.m.MessageBox.show(this.getBundle().getText("DATA_LOSS_WARNING_TEXT"),sap.m.MessageBox.Icon.WARNING,this.getBundle().getText("WARNING"),[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.CANCEL],function(a){if(a==="YES"){oSplBaseApplication.getAppInstance().to((s.hasOwnProperty("sNavToPage")?s.sNavToPage:"splView.tileContainer.MasterTileContainer"));sap.ui.getCore().byId("sapSplBaseUnifiedShell").removeAllHeadItems();}},null,this.fnSyncStyleClass("messageBox"));};
splReusable.libs.Utils.prototype.getCoreInstance=function(){return this.oSapSplCore;};
splReusable.libs.Utils.prototype.setLoggedOnUserDetails=function(v){if(!sap.ui.getCore().getModel("loggedOnUserModel")){sap.ui.getCore().setModel(new sap.ui.model.json.JSONModel(v),"loggedOnUserModel");}else{sap.ui.getCore().getModel("loggedOnUserModel").setData(v,true);}this.oSapSplLoggedOnUserDetails=v;};
splReusable.libs.Utils.prototype.getLoggedOnUserDetails=function(){return this.oSapSplLoggedOnUserDetails;};
splReusable.libs.Utils.prototype.getIsDirty=function(){return this.isPageDirty;};
splReusable.libs.Utils.prototype.setIsDirty=function(i){this.isPageDirty=i;};
splReusable.libs.Utils.prototype.setIntervalId=function(i){this.aIntervalIds.push(i);};
splReusable.libs.Utils.prototype.getIntervalIds=function(){return this.aIntervalIds;};
splReusable.libs.Utils.prototype.saveTime=function(d){this.startDate=d;};
splReusable.libs.Utils.prototype.calculateTime=function(d,m){var s=d-this.startDate;var h=Math.floor(s/1000/60/60);s=s-h*1000*60*60;var a=Math.floor(s/1000/60);s=s-a*1000*60;var b=Math.floor(s/1000);s=s-b*1000;};
splReusable.libs.Utils.prototype.isInIframe=function(i){if(window.self&&window.top){i(window.self!==window.top);}else{throw new Error("Window object not supported by browser");}};
splReusable.libs.Utils.prototype.getSearchItemFilters=function(s,o,n){var r=[],a=false,k;o=o?o:"UUID";if(!this.IsValidArray(s)){jQuery.sap.log.fatal("Invalid array usage","Search result is an invalid object type","splReusable.libs.Utils.getSearchItemFilters");throw new splReusable.exceptions.InvalidArrayException({message:"Invalid filter array",source:"splReusable.libs.Utils.getSearchItemFilters",options:{severity:SapSplEnums.fatal}});}for(var c=0;c<s.length;c++){if(n){k=s[c]["ObjectInfo"]["ObjectKey"];}else{k=this.base64ToHex(s[c]["ObjectInfo"]["ObjectKey"]);}r.push(new sap.ui.model.Filter(o,sap.ui.model.FilterOperator.EQ,k||null));}return new sap.ui.model.Filter(r,a);};
splReusable.libs.Utils.prototype.setStartupError=function(s){this.bStartupError=s;};
splReusable.libs.Utils.prototype.getStartupError=function(){return this.bStartupError;};
splReusable.libs.Utils.prototype.getHelpLinkFromMapping=function(i){var p={},t;p.links=[];if(arguments===undefined||arguments===null||arguments.length<=0){throw new splReusable.exceptions.MissingParametersException({message:"Invalid usage",source:this.toString(),options:{severity:SapSplEnums.fatal}});}if(i.constructor!==Boolean){throw new TypeError();}try{var c,C;for(c=0,C=this.helpLinkMapper.helpLinks.length;c<C;c++){t={};if(i){t.helpLink=this.helpLinkMapper.helpLinks[c]["iLink"];}else{t.helpLink=this.helpLinkMapper.helpLinks[c]["eLink"];}t.helpLinkName=this.getAppNameFromAppId(this.helpLinkMapper.helpLinks[c]["appId"]);t.helpLinkDescription=this.getAppDescriptionFromAppId(this.helpLinkMapper.helpLinks[c]["appId"]);if(t.helpLinkName){p.links.push(t);}}return p;}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"Error in getHelpLinkFromMapping","Utils.js");}}};
splReusable.libs.Utils.prototype.getHelpLinkPerAppFromMapping=function(a){var A={},s=null,c=0;if(arguments===undefined||arguments.length<=0){$.sap.log.error("Help API Usage [Utility]","Invalid usage of interface","SAPSCL");return null;}if(a===null||a===undefined){$.sap.log.error("Help API Usage [Utility]","Invalid application help metadata","SAPSCL");return null;}for(c=0;c<this.getAllowedTilesList().length;c++){if(a===this.getAllowedTilesList()[c]["AppPath"]){s=this.getAllowedTilesList()[c]["AppID"];break;}}for(c=0;c<this.helpLinkMapper.helpLinks.length;c++){if(s===this.helpLinkMapper.helpLinks[c]["appId"]){A=this.helpLinkMapper.helpLinks[c];break;}}return A;};
splReusable.libs.Utils.prototype.getAppNameFromAppId=function(a){var c;for(c=0;c<this.aAllowedTiles.length;c++){if(this.aAllowedTiles[c].AppID===a){return this.aAllowedTiles[c]["AppName"];}}if(c===this.aAllowedTiles.length){return null;}};
splReusable.libs.Utils.prototype.getAppDescriptionFromAppId=function(a){var c;for(c=0;c<this.aAllowedTiles.length;c++){if(this.aAllowedTiles[c].AppID===a){return this.aAllowedTiles[c]["AppName.description"];}}if(c===this.aAllowedTiles.length){return null;}};
splReusable.libs.Utils.prototype.base64ToHex=function(b){if(!arguments||arguments.length<=0){$.sap.log.fatal("Invalid Interface usage","Invalid Interface usage","SAPSCLUTILS");return;}if(b.constructor!==String){$.sap.log.info("Input type compatibility","Input is not of type String.","SAPSCLUTILS");b=b.toString();}function m(e){var M={};var i=0;var f=e.length;for(i=0;i<f;i++){M[e[i]]=i;}return M;}function B(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f=e.split("");var g=new RegExp("^["+e+"]*$");var h=m(f);function k(j){var o=j.byteLength;var r=j.byteLength%3;var q=new DataView(j);var s="";var t=0;var u=0;var v=0;var i=0;var p=0;var M=Math.ceil(j.byteLength/3);var w=[];if(r===1){s="==";}else if(r===2){s="=";}for(i=0;i<M;i++){p=i*3;t=q.getUint8(p);u=(p+1)<o?q.getUint8(p+1):0;v=(p+2)<o?q.getUint8(p+2):0;w.push(f[t>>>2]);w.push(f[((t&0x3)<<4)|(u>>>4)]);if((p+1)<o){w.push(f[((u&0xF)<<2)|(v>>>6)]);}if((p+2)<o){w.push(f[v&0x3F]);}}w.push(s);return w.join("");}function l(C){var v=h[C];if(v===undefined){throw new Error("Base64 string has invalid character "+C);}return v;}function n(o){var t=o.length;var M=Math.ceil(o.length/4);var u=o.length%4;var i=0;var j=0;var p=0;var q=0;var r=0;var s=0;var v=0;var w=0;var x=0;var y=0;var z=Math.floor(o.length/4)*3;if(u===2){z=z+1;}else if(u===3){z=z+2;}if(u===1||z===0){throw new Error("Decode Base 64: input has invalid length. Length should be in (multiples of 4) + (2 or 3) after excluding = character");}if(!g.test(o)){throw new Error("DecodeBase64: Base64 string has invalid character(s)");}var A=new ArrayBuffer(z);var C=new DataView(A);for(i=0;i<M;i++){p=i*4;q=p+1;r=p+2;s=p+3;w=l(o[p])<<2;x=0;y=0;if(q<t){v=l(o[q]);w|=v>>>4;C.setUint8(j++,w);x=(v&0xF)<<4;}if(r<t){v=l(o[r]);x|=v>>>2;C.setUint8(j++,x);y=(v&0x3)<<6;}if(s<t){v=l(o[s]);y|=v;C.setUint8(j++,y);}}return A;}this.encode=function(i){if(!i instanceof ArrayBuffer){throw new Error("BinaryToBase64Encoder.encode(): Input has to be an ArrayBuffer");}return k(i);};this.decode=function(i){if(i===undefined||typeof i!=="string"){throw new Error("BinaryToBase64Encoder.decode(): Input has to be a string");}return n(i.replace(/=/g,""));};}function a(){var h="0123456789ABCDEF";var e=h.split("");var f=new RegExp("^["+h+"]*$");var g=m(h);this.encode=function(j){if(j===undefined||typeof j!=="object"||(!(j instanceof ArrayBuffer))){throw new Error("BinaryToHexEncoder.encode(): Input has to be ArrayBuffer");}var o=[];var k=new DataView(j);var i=0;var M=0;for(i=0,M=j.byteLength;i<M;i++){o.push(e[Math.floor(k.getUint8(i)/0x10)]);o.push(e[Math.floor(k.getUint8(i)%0x10)]);}return o.join("");};this.decode=function(k){if(k===undefined||typeof k!=="string"){throw new Error("BinaryToHexEncoder.decode(): Input has to be Hexadecimal String");}var l=k.toUpperCase();if(!f.test(l)){throw new Error("BinaryToHexEncoder.decode(): Hexadecimal string has invalid character(s))");}if((l.length%2)!==0||l.length===0){throw new Error("BinaryToHexEncoder.decode(): Hexadecimal String input has invalid length. Length should be a multiple of 2");}var o=new ArrayBuffer(Math.floor(l.length/2));var n=new DataView(o);var i=0;var M=0;var j=0;for(i=0,M=o.byteLength;i<M;i++){j=i*2;n.setUint8(i,g[l[j]]*0x10+g[l[j+1]]);}return o;};}var c=new a(),d=new B();return c.encode(d.decode(b));};
splReusable.libs.Utils.prototype.setInQueryParameterMap=function(q,a){this.oSplQueryParametersMap[q]=a;};
splReusable.libs.Utils.prototype.getFromQueryParameterMap=function(q){if(arguments.length<=0){return this.oSplQueryParametersMap;}if(this.oSplQueryParametersMap.hasOwnProperty(q)){return this.oSplQueryParametersMap[q];}else{return null;}};
splReusable.libs.Utils.prototype.setCurrentAppInfo=function(a){if(!a.hasOwnProperty("appHelpUrl")||!a.appHelpUrl.hasOwnProperty("eUrl")){jQuery.sap.log.info(a.eUrl,"","Utils.js");}this.oCurrentAppInfo=a;};
splReusable.libs.Utils.prototype.getCurrentAppInfo=function(){return this.oCurrentAppInfo;};
splReusable.libs.Utils.prototype.setIsNavToAppComplete=function(i){this.isNavToAppComplete=i;return this;};
splReusable.libs.Utils.prototype.getIsNavToAppComplete=function(){return this.isNavToAppComplete;};
splReusable.libs.Utils.prototype.setHelpType=function(h){this.sHelpType=h;return this;};
splReusable.libs.Utils.prototype.getHelpType=function(){return this.sHelpType;};
splReusable.libs.Utils.prototype.getAppConfigObjectFromAllowedTiles=function(a){if(arguments===undefined||arguments.length<=0){throw new splReusable.exceptions.MissingParametersException({message:"Missing arguments. showMessage",source:this.toString(),options:{severity:SapSplEnums.fatal}});}try{if(a.constructor===String){for(var i=0;i<this.getAllowedTilesList().length;i++){if(this.getAllowedTilesList()[i].AppID===a){return this.getAllowedTilesList()[i].AppConfig.results;}}}else{throw new TypeError();}}catch(e){if(e.constructor===Error){jQuery.sap.log.error(e.message,"sAppId is not an string - getAppConfigObjectFromAllowedTiles","Utils.js");}}};
splReusable.libs.Utils.prototype.getDateRange=function(b){var d={from:"",to:""},c=new Date(),C=c.getFullYear(),s=c.getMonth(),t;function g(q){if(q===1){d["from"]=new Date(C-1,9,1);d["to"]=new Date(C,0,0);d["to"].setDate(d["to"].getDate()+1);}else if(q===2){d["from"]=new Date(C,0,1);d["to"]=new Date(C,3,0);d["to"].setDate(d["to"].getDate()+1);}else if(q===3){d["from"]=new Date(C,3,1);d["to"]=new Date(C,6,0);d["to"].setDate(d["to"].getDate()+1);}else if(q===4){d["from"]=new Date(C,6,1);d["to"]=new Date(C,9,0);d["to"].setDate(d["to"].getDate()+1);}return;}function a(f){var i=Math.floor(f/3)+1;return i>3?4:i;}function e(q){if(q===1){d["from"]=new Date(C,0,1);}else if(q===2){d["from"]=new Date(C,3,1);}else if(q===3){d["from"]=new Date(C,6,1);}else if(q===4){d["from"]=new Date(C,9,1);}d["to"]=c;return;}function _(f,T,i){if(i===1){g(a(s));return;}else if(i===2){e(a(s));return;}d["from"]=f;d["to"]=T;}switch(b){case"C":_(new Date(C,s,1),c,0);break;case"L":t=new Date(C,s,0);t.setDate(t.getDate()+1);_(new Date(C,s-1,1),t,0);break;case"Q":_(null,null,1);break;case"QTD":_(null,null,2);break;case"H":_(new Date(C,s-6,1),c,0);break;case"Y":_(new Date(C,0,1),c,0);break;default:}return{from:d["from"],to:d["to"]};};
splReusable.libs.Utils.prototype.getStorageInstance=function(i){var _;if(!i||i===null||i==="session"){_=jQuery.sap.storage(jQuery.sap.storage.Type.session);}else if(i.toLowerCase()==="local"){_=jQuery.sap.storage(jQuery.sap.storage.Type.local);}return _;};
splReusable.libs.Utils.prototype.getKeys=function(i,k){var K={};var s=this.getStorageInstance(i);if((arguments.length<1)||((i.constructor!==String)||(k.constructor!==Array))){throw new splReusable.exceptions.MissingParametersException({source:"getKeys",message:"mandatory arguments missing",options:{severity:"Fatal"}});}else{for(var c=0;c<k.length;c++){if(s.get(k[c])){K[k[c]]=s.get(k[c]);}}}return K;};
splReusable.libs.Utils.prototype.getInitializerDetails=function(){return this.oSapSplInitializerDetails;};
splReusable.libs.Utils.prototype.setInitializerDetails=function(v){this.oSapSplInitializerDetails=v;};
splReusable.libs.Utils.prototype.fnSetSystemType=function(){if(sap.ui.Device.system.combi===true){this.sSystemType=SapSplEnums.COMBI_TYPE;}else if(sap.ui.Device.system.desktop===true){this.sSystemType=SapSplEnums.DESKTOP_TYPE;}else if(sap.ui.Device.system.phone===true){this.sSystemType=SapSplEnums.PHONE_TYPE;}else if(sap.ui.Device.system.tablet===true){this.sSystemType=SapSplEnums.TABLET_TYPE;}};
splReusable.libs.Utils.prototype.fnGetSystemType=function(){return this.sSystemType;};
splReusable.libs.Utils.prototype.fnSyncStyleClass=function(c){if(c.constructor===String&&c==="messageBox"){if(this.sSystemType===SapSplEnums.DESKTOP_TYPE){return"sapUiSizeCompact";}else{return"";}}else{if(this.sSystemType===SapSplEnums.DESKTOP_TYPE){jQuery.sap.syncStyleClass("sapUiSizeCompact",$("#sapSplBaseUnifiedShell"),c);}}};
splReusable.libs.Utils.prototype.setHCBMode=function(_){var t=(_)?jQuery.sap.log.info("SAP SCL Theme check","Launching in HCB mode","SAPSCL"):jQuery.sap.log.info("SAP SCL Theme check","Launching in default theme","SAPSCL");this.bIsInHCBMode=_;};
splReusable.libs.Utils.prototype.bIsInternetExplorer=function(){return(sap.ui.Device.browser.name==="ie");};
splReusable.libs.Utils.prototype.isInHCBMode=function(){return this.bIsInHCBMode;};
splReusable.libs.Utils.prototype.setReferrer=function(){if(this.sReferrer===null){this.sReferrer=document.URL.toString();}};
splReusable.libs.Utils.prototype.getReferrer=function(){return this.sReferrer;};
var oSapSplUtils=new splReusable.libs.Utils();
