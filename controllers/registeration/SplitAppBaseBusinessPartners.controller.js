/*
 * Copyright (C) 2009-2015 SAP SE or an SAP affiliate company. All rights reserved.
 */
jQuery.sap.require("sap.ca.ui.message.message");sap.ui.controller("splController.registeration.SplitAppBaseBusinessPartners",{getViewRegistry:function(){return[{"from":"MyBusinessPartnerMaster","to":"MyBusinessPartnerDetail"},{"from":"MyBusinessPartnerDetail","to":"NewBusinessPartnerRegistrationDetail"},{"from":"MyBusinessPartnerActionSheet","to":"NewBusinessPartnerRegistrationDetail"},{"from":"FreelancerActionSheet","to":"FreelancerConnectDetail"},{"from":"NewBusinessPartnerRegistrationDetail","to":"MyBusinessPartnerDetail"},{"from":"FreelancerConnectDetail","to":"MyBusinessPartnerDetail"},{"from":"FreelancerActionSheetInvite","to":"NewBusinessPartnerRegistrationDetail"}];},onBeforeShow:function(e){sap.ui.getCore().getModel("myBusinessPartnerListODataModel").refresh();sap.ui.getCore().getModel("sapSplAppConfigDataModel").setData(oSapSplUtils.getAppConfigObjectFromAllowedTiles(this.appID)[0]);this.setCurrentAppInfo(e);if(sap.ui.getCore().getModel("myBusinessPartnerDetailModel")&&this.getView().byId("SplitAppBaseBusinessPartners")){this.getView().byId("SplitAppBaseBusinessPartners").toDetail("MyBusinessPartnerDetail");var m=sap.ui.getCore().getModel("myBusinessPartnerDetailModel").getData();m["isClicked"]=false;m["noData"]=true;m["showFooterOptions"]=false;sap.ui.getCore().getModel("myBusinessPartnerDetailModel").setData(m);}},onAfterShow:function(){var c=new sap.ui.core.CustomData({key:"bRefreshTile",value:true});oSplBaseApplication.getAppInstance().getCurrentPage().destroyCustomData();oSplBaseApplication.getAppInstance().getCurrentPage().addCustomData(c);},setCurrentAppInfo:function(e){oSapSplHelpHandler.setAppHelpInfo({iUrl:"./help/SCLBuPa.pdf",eUrl:"//help.sap.com/saphelp_scl10/helpdata/en/d4/dbe153cafa9117e10000000a44176d/content.htm?frameset=/en/52/02e3537a0e9438e10000000a44176d/frameset.htm&current_toc=/en/b7/8ee25341d61e4ee10000000a423f68/plain.htm&node_id=9&show_children=false"},e);},subscribeNavigationEvents:function(){var b=sap.ui.getCore().getEventBus();b.subscribe("navInMasterBP","to",jQuery.proxy(this.navInMaster_To,this));b.subscribe("navInDetailBP","to",jQuery.proxy(this.navInDetail_To,this));b.subscribe("navInDetailBP","back",jQuery.proxy(this.navInDetail_Back,this));b.subscribe("navInMasterBP","back",jQuery.proxy(this.navInMaster_Back,this));},instantiatePages:function(){splReusable.libs.SplTracer.trace(0,"BuPa instantiatePages()");var m=null;var a=null;m=sap.ui.view({id:"MyBusinessPartnerMaster",viewName:"splView.registeration.MyBusinessPartnerMaster",type:sap.ui.core.mvc.ViewType.XML,viewData:this.getView()});m.getController().setSplitAppInstance(this.byId("SplitAppBaseBusinessPartners"));m.addEventDelegate({onBeforeShow:jQuery.proxy(m.getController().onBeforeShow,m.getController())});m.getController().setUnifiedShellInstance(this.getUnifiedShellInstance());this.getView().byId("SplitAppBaseBusinessPartners").addMasterPage(m);a=sap.ui.view({id:"MyBusinessPartnerDetail",viewName:"splView.registeration.MyBusinessPartnerDetail",type:sap.ui.core.mvc.ViewType.XML});a.getController().setSplitAppInstance(this.byId("SplitAppBaseBusinessPartners"));a.addEventDelegate({onBeforeShow:jQuery.proxy(a.getController().onBeforeShow,a.getController())});a.getController().setUnifiedShellInstance(this.getUnifiedShellInstance());this.getView().byId("SplitAppBaseBusinessPartners").addDetailPage(a);splReusable.libs.SapSplStyleSheetLoader.loadStyle("./resources/styles/splContactRegistration");splReusable.libs.SplTracer.trace(1,"BuPa instantiatePages()");},setInitialState:function(){this.getView().byId("SplitAppBaseBusinessPartners").setInitialMaster("MyBusinessPartnerMaster");this.getView().byId("SplitAppBaseBusinessPartners").setInitialDetail("MyBusinessPartnerDetail");if(jQuery.sap.getUriParameters().get("navToHome")&&jQuery.sap.getUriParameters().get("navToHome")==="true"){oSapSplUtils.showHeaderButton({showButton:true,sNavToPage:"splView.tileContainer.MasterTileContainer"});}},createODataModelForMyBusinessPartners:function(){var m=sap.ui.getCore().getModel("myBusinessPartnerListODataModel");splReusable.libs.SplTracer.trace(0,"BuPa createODataModelForMyBusinessPartners()");if(m===undefined||m===null){m=new splModels.odata.ODataModel({url:oSapSplUtils.getFQServiceUrl("/sap/spl/xs/app/services/appl.xsodata/"),json:true,tokenHandling:true,withCredentials:false,loadMetadataAsync:true,handleTimeOut:true,numberOfSecondsBeforeTimeOut:10000});m.attachEvent("timeOut",function(){sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:oSapSplUtils.getBundle().getText("TIMEOUT_ALERT")});});sap.ui.getCore().setModel(m,"myBusinessPartnerListODataModel");}splReusable.libs.SplTracer.trace(1,"BuPa createODataModelForMyBusinessPartners()");},onInit:function(){this.oSplitAppBase=this.getView().byId("SplitAppBaseBusinessPartners");this.aSplViewsRegistry=this.getViewRegistry();oSapSplUtils.setSplitAppBaseTwo(this);this.subscribeNavigationEvents();this.createODataModelForMyBusinessPartners();this.instantiatePages();this.setInitialState();this.appID="myBusinessPartners";},onAfterRendering:function(){},getUnifiedShellInstance:function(){return this.unifiedShell;},setUnifiedShellInstance:function(u){this.unifiedShell=u;},navInMaster_To:function(E,d,D){var f="";try{if(typeof d==="string"&&typeof D==="object"){f=D.from.sId;if(!D.data){D.data=null;}if(f&&typeof f==="string"){var t=this.getSplViewsRegistry(D.from.sId);if(t&&typeof t==="string"){this.oSplitAppBase.toMaster(t,"fade",D.data);}else{throw new Error();}}else{throw new Error();}}else{throw new Error();}}catch(e){if(e.constructor===Error()){jQuery.sap.log.error(e.message,"Parameters for navigation not in proper format",this.getView().getControllerName());}}},navInDetail_To:function(E,d,D){var f="";try{if(typeof d==="string"&&typeof D==="object"){f=D.from.sId;if(!D.data){D.data=null;}if(f&&typeof f==="string"){var t=this.getSplViewsRegistry(D.from.sId);if(t&&typeof t==="string"){this.oSplitAppBase.toDetail(t,"fade",D.data);}else{throw new Error();}}else{throw new Error();}}else{throw new Error();}}catch(e){if(e.constructor===Error()){jQuery.sap.log.error(e.message,"Parameters for navigation not in proper format",this.getView().getControllerName());}}},navInDetail_Back:function(E,d,D){if(!D.data){D.data=null;}try{if(d&&typeof d==="string"){this.oSplitAppBase.backDetail(D.data);}else{throw new Error();}}catch(e){if(e.constructor===Error()){jQuery.sap.log.error(e.message,"Parameters for navigation not in proper format",this.getView().getControllerName());}}},navInMaster_Back:function(E,d,D){if(!D.data){D.data=null;}try{if(d&&typeof d==="string"){this.oSplitAppBase.backMaster(D.data);}else{throw new Error();}}catch(e){if(e.constructor===Error()){jQuery.sap.log.error(e.message,"Parameters for navigation not in proper format",this.getView().getControllerName());}}},getSplViewsRegistry:function(v){var _=null;try{if(v&&typeof v==="string"){if(this.aSplViewsRegistry!==undefined){for(var i=0,j=this.aSplViewsRegistry.length;i<j;i++){if(this.aSplViewsRegistry[i].from===v){if(this.aSplViewsRegistry[i].to){_=this.aSplViewsRegistry[i].to;}else{throw new Error();}}}}else{throw new Error();}}else{throw new Error();}return _;}catch(e){if(e.constructor===Error()){jQuery.sap.log.error(e.message,"View ID is not string",this.getView().getControllerName());}}}});
