/*
 * Copyright (C) 2009-2015 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.controller("splDemoController.SPLDemoAppIncidentActivation",{onInit:function(){this.oODataModel=new sap.ui.model.odata.ODataModel(oSapSplUtils.getFQServiceUrl("sap/spl/xs/demoSetup/services/demo.xsodata"),true);this.oModelForVehicles=new sap.ui.model.json.JSONModel();this.oModelForPaths=new sap.ui.model.json.JSONModel();this.oODataModel.setSizeLimit(1000);this.oMappingObject={};this.getView().oOrgSelect.setModel(this.oODataModel);this.getView().oVehiclesTable.setModel(this.oModelForVehicles);},fnHandleChangeEventOfOrgSelect:function(e){var t=this;var U=e.getParameters().selectedItem.getBindingContext().getObject()["UUID"];U=oSapSplUtils.base64ToHex(U);var f="$filter=("+encodeURIComponent("OwnerID eq "+"X"+"\'"+U+"\'")+")";this.oODataModel.read("/IncidentMaster",null,[f],false,function(d){t.oModelForVehicles.setData(d.results);},function(){});},fnHandleAssignAction:function(){var p=[];jQuery.each(this.oMappingObject,function(k,v){p.push({UUID:k,activate:v});});if(p.length>0){$.ajax({url:oSapSplUtils.getFQServiceUrl("/sap/spl/xs/demoSetup/services/activateIncident.xsjs"),type:"POST",contentType:"json; charset=UTF-8",async:false,beforeSend:function(){},data:JSON.stringify({data:p}),success:function(d,s,m){if(d.constructor===String){d=JSON.parse(d);}if(m["status"]===200&&d["Error"].length===0){sap.m.MessageToast.show("Activation Done");}},error:function(){sap.m.MessageToast.show("Activation Error");},complete:function(){}});}},fnHandleSelectEventOfCheckBox:function(e){this.oMappingObject[e.getSource().getBindingContext().getObject()["UUID"]]=e.getParameters().selected;},onAfterRendering:function(){},onBeforeRendering:function(){},onBeforeShow:function(){}});
